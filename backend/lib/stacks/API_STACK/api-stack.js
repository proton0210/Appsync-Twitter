"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.ApiStack = void 0;
const NotifyRetweeted_1 = require("./Constructs/NotifyRetweeted");
const HashTagConstruct_1 = require("./Constructs/HashTagConstruct");
const GetFollowingConstruct_1 = require("./Constructs/GetFollowingConstruct");
const UnfollowConstruct_1 = require("./Constructs/UnfollowConstruct");
const NestedFollowingProfie_1 = require("./Constructs/NestedFollowingProfie");
const NestedInReplyToUsers_1 = require("./Constructs/NestedInReplyToUsers");
const NestedInReplToTweet_1 = require("./Constructs/NestedInReplToTweet");
const NestedReplyProfile_1 = require("./Constructs/NestedReplyProfile");
const ReplyConstruct_1 = require("./Constructs/ReplyConstruct");
const NestedTweetRetweeted_1 = require("./Constructs/NestedTweetRetweeted");
const NestedRetweetOf_1 = require("./Constructs/NestedRetweetOf");
const Nested_RetweetProfile_1 = require("./Constructs/Nested_RetweetProfile");
const RetweetConstruct_1 = require("./Constructs/RetweetConstruct");
const Nested_OtherProfileTweet_1 = require("./Constructs/Nested_OtherProfileTweet");
const Nested_MyProfileTweet_1 = require("./Constructs/Nested_MyProfileTweet");
const GetLikesConstruct_1 = require("./Constructs/GetLikesConstruct");
const UnlikeConstruct_1 = require("./Constructs/UnlikeConstruct");
const NestedLiked_1 = require("./Constructs/NestedLiked");
const LikeContruct_1 = require("./Constructs/LikeContruct");
const NestedUnhydratedTweets_1 = require("./Constructs/NestedUnhydratedTweets");
const GetMyTimeLine_1 = require("./Constructs/GetMyTimeLine");
const TweetConstruct_1 = require("./Constructs/TweetConstruct");
const GetMyProfileConstruct_1 = require("./Constructs/GetMyProfileConstruct");
const cdk = require("aws-cdk-lib");
const appsync = require("@aws-cdk/aws-appsync-alpha");
const path = require("path");
const EditMyProfileConstruct_1 = require("./Constructs/EditMyProfileConstruct");
const GetImageUploadUrlConstruct_1 = require("./Constructs/GetImageUploadUrlConstruct");
const GetTweetsConstuct_1 = require("./Constructs/GetTweetsConstuct");
const NestedProfile_Type_Tweet_1 = require("./Constructs/NestedProfile_Type_Tweet");
const UnRetweetConstruct_1 = require("./Constructs/UnRetweetConstruct");
const NestedReplyRetweeted_1 = require("./Constructs/NestedReplyRetweeted");
const NestedReplyLike_1 = require("./Constructs/NestedReplyLike");
const FollowConstruct_1 = require("./Constructs/FollowConstruct");
const NestedFollowedByProfile_1 = require("./Constructs/NestedFollowedByProfile");
const GetProfileConstruct_1 = require("./Constructs/GetProfileConstruct");
const GetFollowersConstruct_1 = require("./Constructs/GetFollowersConstruct");
const SearchConstruct_1 = require("./Constructs/SearchConstruct");
const onNotifiedConstrcut_1 = require("./Constructs/onNotifiedConstrcut");
const NotifyLiked_1 = require("./Constructs/NotifyLiked");
const NotifyMention_1 = require("./Constructs/NotifyMention");
const NotifyReplied_1 = require("./Constructs/NotifyReplied");
const SendDirectMessage_1 = require("./Constructs/SendDirectMessage");
const NestedOtherUserConversationConstruct_1 = require("./Constructs/NestedOtherUserConversationConstruct");
class ApiStack extends cdk.Stack {
    constructor(scope, id, props) {
        super(scope, id, props);
        this.api = new appsync.GraphqlApi(this, 'Api', {
            name: 'twitter-api',
            schema: appsync.Schema.fromAsset(path.join(__dirname, 'Schema/schema.api.graphql')),
            authorizationConfig: {
                defaultAuthorization: {
                    authorizationType: appsync.AuthorizationType.USER_POOL,
                    userPoolConfig: {
                        userPool: props.userPool
                    }
                },
                // additional iam auth
                additionalAuthorizationModes: [
                    {
                        authorizationType: appsync.AuthorizationType.IAM
                    }
                ]
            }
        });
        this.props = props;
        this.queries();
        this.mutations();
        this.nestedResolvers();
        this.subscriptions();
        //output API URL
        new cdk.CfnOutput(this, 'GraphQLAPIURL', {
            value: this.api.graphqlUrl
        });
    }
    queries() {
        new GetMyProfileConstruct_1.GetMyProfileResolver(this, 'QueryGetMyProfileResolver', this.api, this.props.usersTable).resolver;
        const getImageUploadUrl = new GetImageUploadUrlConstruct_1.GetImageUploadURL(this, 'QueryGetImageUploadUrl', this.api);
        getImageUploadUrl.resolver;
        this.imageUploadFunction = getImageUploadUrl.getImageUploadURLfunction;
        new GetTweetsConstuct_1.GetTweetsResolver(this, 'QueryGetTweetsResolver', this.api, this.props.tweetsTable).resolver;
        new GetMyTimeLine_1.GetMyTimeLine(this, 'QueryGetMyTimeLineResolver', this.api, this.props.timelinesTable).resolver;
        new GetLikesConstruct_1.GetLikes(this, 'QueryGetLikesResolver', this.api, this.props.likesTable)
            .resolver;
        new GetProfileConstruct_1.GetProfile(this, 'QueryGetProfile', this.api, this.props.usersTable)
            .resolver;
        // This is pipeline resolver example
        new GetFollowersConstruct_1.GetFollowers(this, 'QueryGetFollowers', this.api, this.props.relationshipsTable, this.props.usersTable).resolver;
        new GetFollowingConstruct_1.GetFollowing(this, 'QueryGetFollowing', this.api, this.props.relationshipsTable, this.props.usersTable).resolver;
        new SearchConstruct_1.Search(this, 'QuerySearch', this.api).resolver;
        new HashTagConstruct_1.Hashtag(this, 'QueryHashtag', this.api).resolver;
    }
    nestedResolvers() {
        new NestedProfile_Type_Tweet_1.NestedProfileTweet(this, 'NestedProfileTweet', this.api, this.props.usersTable).resolver;
        new NestedUnhydratedTweets_1.NestedUnhydratedTweetsPage(this, 'NestedUnhydratedTweetsPage', this.api, this.props.tweetsTable).resolver;
        new NestedLiked_1.NestedLiked(this, 'NestedLiked', this.api, this.props.likesTable)
            .resolver;
        new Nested_MyProfileTweet_1.NestedMyProfile(this, 'NestedMyProfile', this.api, this.props.tweetsTable).resolver;
        new Nested_OtherProfileTweet_1.NestedOtherProfile(this, 'NestedOtherProfile', this.api, this.props.tweetsTable).resolver;
        new Nested_RetweetProfile_1.NestedRetweetProfile(this, 'NestedRetweetProfile', this.api, this.props.usersTable).resolver;
        new NestedRetweetOf_1.NestedRetweetOf(this, 'NestedRetweetOf', this.api, this.props.tweetsTable).resolver;
        new NestedTweetRetweeted_1.NestedTweetRetweeted(this, 'NestedTweetRetweeted', this.api, this.props.retweetsTable).resolver;
        new NestedReplyProfile_1.NestedReplyProfile(this, 'NestedReplyProfile', this.api, this.props.usersTable).resolver;
        new NestedInReplToTweet_1.NestedInReplyToTweet(this, 'NestedInReplyToTweet', this.api, this.props.tweetsTable).resolver;
        new NestedInReplyToUsers_1.NestedInReplyToUsers(this, 'NestedInReplyToUsers', this.api, this.props.usersTable).resolver;
        new NestedReplyRetweeted_1.NestedReplyRetweeted(this, 'NestedReplyRetweeted', this.api, this.props.retweetsTable).resolver;
        new NestedReplyLike_1.NestedReplyLike(this, 'NestedReplyLike', this.api, this.props.likesTable).resolver;
        new NestedFollowingProfie_1.NestedFollowingOtherProfile(this, 'NestedFollowingOtherProfile', this.api, this.props.relationshipsTable).resolver;
        new NestedFollowedByProfile_1.NestedFollowedByOtherProfile(this, 'NestedFollowedByOtherProfile', this.api, this.props.relationshipsTable).resolver;
        new NestedOtherUserConversationConstruct_1.OtherUserConversation(this, 'OtherUserConversation', this.api, this.props.usersTable).resolver;
    }
    // id string should be unique for each construct
    mutations() {
        new EditMyProfileConstruct_1.EditMyProfile(this, 'EditMyProfileResolver', this.api, this.props.usersTable).resolver;
        //Tweet Mutation
        const tweetMutation = new TweetConstruct_1.Tweet(this, 'TweetMutation', this.api);
        tweetMutation.resolver;
        this.props.usersTable.grantFullAccess(tweetMutation.Tweetfunction);
        this.props.tweetsTable.grantFullAccess(tweetMutation.Tweetfunction);
        this.props.timelinesTable.grantFullAccess(tweetMutation.Tweetfunction);
        //RetweetMutation
        const retweetMutation = new RetweetConstruct_1.Retweet(this, 'RetweetMutation', this.api);
        retweetMutation.resolver;
        this.props.usersTable.grantFullAccess(retweetMutation.Retweetfunction);
        this.props.tweetsTable.grantFullAccess(retweetMutation.Retweetfunction);
        this.props.timelinesTable.grantFullAccess(retweetMutation.Retweetfunction);
        this.props.retweetsTable.grantFullAccess(retweetMutation.Retweetfunction);
        //UnRetweetMutation
        const unretweetMutation = new UnRetweetConstruct_1.UnRetweet(this, 'UnRetweetMutation', this.api);
        unretweetMutation.resolver;
        this.props.usersTable.grantFullAccess(unretweetMutation.UnRetweetFunction);
        this.props.tweetsTable.grantFullAccess(unretweetMutation.UnRetweetFunction);
        this.props.timelinesTable.grantFullAccess(unretweetMutation.UnRetweetFunction);
        this.props.retweetsTable.grantFullAccess(unretweetMutation.UnRetweetFunction);
        //ReplyMutation
        const replyMutation = new ReplyConstruct_1.Reply(this, 'ReplyMutation', this.api);
        replyMutation.resolver;
        this.props.usersTable.grantFullAccess(replyMutation.Replyfunction);
        this.props.tweetsTable.grantFullAccess(replyMutation.Replyfunction);
        this.props.timelinesTable.grantFullAccess(replyMutation.Replyfunction);
        //Like Mutation
        // Manually have to add access in the service role from console for tweets and users table
        const LikeMutation = new LikeContruct_1.Like(this, 'LikeMutation', this.api, this.props.likesTable);
        LikeMutation.resolver;
        //Unlike Mutation
        // Manually have to add access in the service role from console for tweets and users table
        const UnlikeMutation = new UnlikeConstruct_1.Unlike(this, 'UnlikeMutation', this.api, this.props.likesTable);
        UnlikeMutation.resolver;
        //Follow Mutation
        // Manually add access in the service role from console for users table
        const FollowMutation = new FollowConstruct_1.Follow(this, 'FollowMutation', this.api, this.props.relationshipsTable).resolver;
        //Unfollow Mutation
        // Manually add access in the service role from console for users table
        const UnfollowMutation = new UnfollowConstruct_1.UnFollow(this, 'UnfollowMutation', this.api, this.props.relationshipsTable).resolver;
        new NotifyRetweeted_1.NotifyRetweeted(this, 'NotifyRetweeted', this.api, this.props.notificationsTable);
        new NotifyLiked_1.NotifyLiked(this, 'NotifyLiked', this.api, this.props.notificationsTable);
        new NotifyMention_1.NotifyMention(this, 'NotifyMention', this.api, this.props.notificationsTable);
        new NotifyReplied_1.NotifyReplied(this, 'NotifyReplied', this.api, this.props.notificationsTable);
        const sendDirectMessageMutation = new SendDirectMessage_1.SendDirectMessage(this, 'SendDirectMessageMutation', this.api);
        sendDirectMessageMutation.resolver;
        this.props.conversationsTable.grantFullAccess(sendDirectMessageMutation.SendDirectMessagefunction);
        this.props.directMessagesTable.grantFullAccess(sendDirectMessageMutation.SendDirectMessagefunction);
    }
    subscriptions() {
        new onNotifiedConstrcut_1.OnNotified(this, 'OnNotifiedSubscription', this.api);
    }
}
exports.ApiStack = ApiStack;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiYXBpLXN0YWNrLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiYXBpLXN0YWNrLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7OztBQUFBLGtFQUErRDtBQUMvRCxvRUFBd0Q7QUFDeEQsOEVBQWtFO0FBQ2xFLHNFQUEwRDtBQUMxRCw4RUFBaUY7QUFDakYsNEVBQXlFO0FBQ3pFLDBFQUF3RTtBQUN4RSx3RUFBcUU7QUFDckUsZ0VBQW9EO0FBQ3BELDRFQUF5RTtBQUN6RSxrRUFBK0Q7QUFDL0QsOEVBQTBFO0FBQzFFLG9FQUF3RDtBQUN4RCxvRkFBMkU7QUFDM0UsOEVBQXFFO0FBQ3JFLHNFQUEwRDtBQUMxRCxrRUFBc0Q7QUFDdEQsMERBQXVEO0FBQ3ZELDREQUFpRDtBQUNqRCxnRkFBaUY7QUFDakYsOERBQTJEO0FBQzNELGdFQUFvRDtBQUNwRCw4RUFBMEU7QUFFMUUsbUNBQW1DO0FBRW5DLHNEQUFzRDtBQUN0RCw2QkFBNkI7QUFDN0IsZ0ZBQW9FO0FBQ3BFLHdGQUE0RTtBQUM1RSxzRUFBbUU7QUFDbkUsb0ZBQTJFO0FBQzNFLHdFQUE0RDtBQUM1RCw0RUFBeUU7QUFDekUsa0VBQStEO0FBQy9ELGtFQUFzRDtBQUN0RCxrRkFBb0Y7QUFDcEYsMEVBQThEO0FBQzlELDhFQUFrRTtBQUNsRSxrRUFBc0Q7QUFDdEQsMEVBQThEO0FBQzlELDBEQUF1RDtBQUN2RCw4REFBMkQ7QUFDM0QsOERBQTJEO0FBQzNELHNFQUFtRTtBQUNuRSw0R0FBMEY7QUFDMUYsTUFBYSxRQUFTLFNBQVEsR0FBRyxDQUFDLEtBQUs7SUFNckMsWUFBWSxLQUFnQixFQUFFLEVBQVUsRUFBRSxLQUFvQjtRQUM1RCxLQUFLLENBQUMsS0FBSyxFQUFFLEVBQUUsRUFBRSxLQUFLLENBQUMsQ0FBQztRQUN4QixJQUFJLENBQUMsR0FBRyxHQUFHLElBQUksT0FBTyxDQUFDLFVBQVUsQ0FBQyxJQUFJLEVBQUUsS0FBSyxFQUFFO1lBQzdDLElBQUksRUFBRSxhQUFhO1lBQ25CLE1B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QixDQUM5QixDQUFDO1FBRUYsTUFBTSx5QkFBeUIsR0FBRyxJQUFJLHFDQUFpQixDQUNyRCxJQUFJLEVBQ0osMkJBQTJCLEVBQzNCLElBQUksQ0FBQyxHQUFHLENBQ1QsQ0FBQztRQUNGLHlCQUF5QixDQUFDLFFBQVEsQ0FBQztRQUNuQyxJQUFJLENBQUMsS0FBSyxDQUFDLGtCQUFrQixDQUFDLGVBQWUsQ0FDM0MseUJBQXlCLENBQUMseUJBQXlCLENBQ3BELENBQUM7UUFDRixJQUFJLENBQUMsS0FBSyxDQUFDLG1CQUFtQixDQUFDLGVBQWUsQ0FDNUMseUJBQXlCLENBQUMseUJBQXlCLENBQ3BELENBQUM7SUFDSixDQUFDO0lBRU0sYUFBYTtRQUNsQixJQUFJLGdDQUFVLENBQUMsSUFBSSxFQUFFLHdCQUF3QixFQUFFLElBQUksQ0FBQyxHQUFHLENBQUMsQ0FBQztJQUMzRCxDQUFDO0NBQ0Y7QUFqVkQsNEJBaVZDIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgTm90aWZ5UmV0d2VldGVkIH0gZnJvbSAnLi9Db25zdHJ1Y3RzL05vdGlmeVJldHdlZXRlZCc7XG5pbXBvcnQgeyBIYXNodGFnIH0gZnJvbSAnLi9Db25zdHJ1Y3RzL0hhc2hUYWdDb25zdHJ1Y3QnO1xuaW1wb3J0IHsgR2V0Rm9sbG93aW5nIH0gZnJvbSAnLi9Db25zdHJ1Y3RzL0dldEZvbGxvd2luZ0NvbnN0cnVjdCc7XG5pbXBvcnQgeyBVbkZvbGxvdyB9IGZyb20gJy4vQ29uc3RydWN0cy9VbmZvbGxvd0NvbnN0cnVjdCc7XG5pbXBvcnQgeyBOZXN0ZWRGb2xsb3dpbmdPdGhlclByb2ZpbGUgfSBmcm9tICcuL0NvbnN0cnVjdHMvTmVzdGVkRm9sbG93aW5nUHJvZmllJztcbmltcG9ydCB7IE5lc3RlZEluUmVwbHlUb1VzZXJzIH0gZnJvbSAnLi9Db25zdHJ1Y3RzL05lc3RlZEluUmVwbHlUb1VzZXJzJztcbmltcG9ydCB7IE5lc3RlZEluUmVwbHlUb1R3ZWV0IH0gZnJvbSAnLi9Db25zdHJ1Y3RzL05lc3RlZEluUmVwbFRvVHdlZXQnO1xuaW1wb3J0IHsgTmVzdGVkUmVwbHlQcm9maWxlIH0gZnJvbSAnLi9Db25zdHJ1Y3RzL05lc3RlZFJlcGx5UHJvZmlsZSc7XG5pbXBvcnQgeyBSZXBseSB9IGZyb20gJy4vQ29uc3RydWN0cy9SZXBseUNvbnN0cnVjdCc7XG5pbXBvcnQgeyBOZXN0ZWRUd2VldFJldHdlZXRlZCB9IGZyb20gJy4vQ29uc3RydWN0cy9OZXN0ZWRUd2VldFJldHdlZXRlZCc7XG5pbXBvcnQgeyBOZXN0ZWRSZXR3ZWV0T2YgfSBmcm9tICcuL0NvbnN0cnVjdHMvTmVzdGVkUmV0d2VldE9mJztcbmltcG9ydCB7IE5lc3RlZFJldHdlZXRQcm9maWxlIH0gZnJvbSAnLi9Db25zdHJ1Y3RzL05lc3RlZF9SZXR3ZWV0UHJvZmlsZSc7XG5pbXBvcnQgeyBSZXR3ZWV0IH0gZnJvbSAnLi9Db25zdHJ1Y3RzL1JldHdlZXRDb25zdHJ1Y3QnO1xuaW1wb3J0IHsgTmVzdGVkT3RoZXJQcm9maWxlIH0gZnJvbSAnLi9Db25zdHJ1Y3RzL05lc3RlZF9PdGhlclByb2ZpbGVUd2VldCc7XG5pbXBvcnQgeyBOZXN0ZWRNeVByb2ZpbGUgfSBmcm9tICcuL0NvbnN0cnVjdHMvTmVzdGVkX015UHJvZmlsZVR3ZWV0JztcbmltcG9ydCB7IEdldExpa2VzIH0gZnJvbSAnLi9Db25zdHJ1Y3RzL0dldExpa2VzQ29uc3RydWN0JztcbmltcG9ydCB7IFVubGlrZSB9IGZyb20gJy4vQ29uc3RydWN0cy9Vbmxpa2VDb25zdHJ1Y3QnO1xuaW1wb3J0IHsgTmVzdGVkTGlrZWQgfSBmcm9tICcuL0NvbnN0cnVjdHMvTmVzdGVkTGlrZWQnO1xuaW1wb3J0IHsgTGlrZSB9IGZyb20gJy4vQ29uc3RydWN0cy9MaWtlQ29udHJ1Y3QnO1xuaW1wb3J0IHsgTmVzdGVkVW5oeWRyYXRlZFR3ZWV0c1BhZ2UgfSBmcm9tICcuL0NvbnN0cnVjdHMvTmVzdGVkVW5oeWRyYXRlZFR3ZWV0cyc7XG5pbXBvcnQgeyBHZXRNeVRpbWVMaW5lIH0gZnJvbSAnLi9Db25zdHJ1Y3RzL0dldE15VGltZUxpbmUnO1xuaW1wb3J0IHsgVHdlZXQgfSBmcm9tICcuL0NvbnN0cnVjdHMvVHdlZXRDb25zdHJ1Y3QnO1xuaW1wb3J0IHsgR2V0TXlQcm9maWxlUmVzb2x2ZXIgfSBmcm9tICcuL0NvbnN0cnVjdHMvR2V0TXlQcm9maWxlQ29uc3RydWN0JztcbmltcG9ydCB7IEFwaVN0YWNrUHJvcHMgfSBmcm9tICcuLy4uLy4uLy4uL0ludGVyZmFjZXMvYXBpLWludGVyZmFjZSc7XG5pbXBvcnQgKiBhcyBjZGsgZnJvbSAnYXdzLWNkay1saWInO1xuaW1wb3J0IHsgQ29uc3RydWN0IH0gZnJvbSAnY29uc3RydWN0cyc7XG5pbXBvcnQgKiBhcyBhcHBzeW5jIGZyb20gJ0Bhd3MtY2RrL2F3cy1hcHBzeW5jLWFscGhhJztcbmltcG9ydCAqIGFzIHBhdGggZnJvbSAncGF0aCc7XG5pbXBvcnQgeyBFZGl0TXlQcm9maWxlIH0gZnJvbSAnLi9Db25zdHJ1Y3RzL0VkaXRNeVByb2ZpbGVDb25zdHJ1Y3QnO1xuaW1wb3J0IHsgR2V0SW1hZ2VVcGxvYWRVUkwgfSBmcm9tICcuL0NvbnN0cnVjdHMvR2V0SW1hZ2VVcGxvYWRVcmxDb25zdHJ1Y3QnO1xuaW1wb3J0IHsgR2V0VHdlZXRzUmVzb2x2ZXIgfSBmcm9tICcuL0NvbnN0cnVjdHMvR2V0VHdlZXRzQ29uc3R1Y3QnO1xuaW1wb3J0IHsgTmVzdGVkUHJvZmlsZVR3ZWV0IH0gZnJvbSAnLi9Db25zdHJ1Y3RzL05lc3RlZFByb2ZpbGVfVHlwZV9Ud2VldCc7XG5pbXBvcnQgeyBVblJldHdlZXQgfSBmcm9tICcuL0NvbnN0cnVjdHMvVW5SZXR3ZWV0Q29uc3RydWN0JztcbmltcG9ydCB7IE5lc3RlZFJlcGx5UmV0d2VldGVkIH0gZnJvbSAnLi9Db25zdHJ1Y3RzL05lc3RlZFJlcGx5UmV0d2VldGVkJztcbmltcG9ydCB7IE5lc3RlZFJlcGx5TGlrZSB9IGZyb20gJy4vQ29uc3RydWN0cy9OZXN0ZWRSZXBseUxpa2UnO1xuaW1wb3J0IHsgRm9sbG93IH0gZnJvbSAnLi9Db25zdHJ1Y3RzL0ZvbGxvd0NvbnN0cnVjdCc7XG5pbXBvcnQgeyBOZXN0ZWRGb2xsb3dlZEJ5T3RoZXJQcm9maWxlIH0gZnJvbSAnLi9Db25zdHJ1Y3RzL05lc3RlZEZvbGxvd2VkQnlQcm9maWxlJztcbmltcG9ydCB7IEdldFByb2ZpbGUgfSBmcm9tICcuL0NvbnN0cnVjdHMvR2V0UHJvZmlsZUNvbnN0cnVjdCc7XG5pbXBvcnQgeyBHZXRGb2xsb3dlcnMgfSBmcm9tICcuL0NvbnN0cnVjdHMvR2V0Rm9sbG93ZXJzQ29uc3RydWN0JztcbmltcG9ydCB7IFNlYXJjaCB9IGZyb20gJy4vQ29uc3RydWN0cy9TZWFyY2hDb25zdHJ1Y3QnO1xuaW1wb3J0IHsgT25Ob3RpZmllZCB9IGZyb20gJy4vQ29uc3RydWN0cy9vbk5vdGlmaWVkQ29uc3RyY3V0JztcbmltcG9ydCB7IE5vdGlmeUxpa2VkIH0gZnJvbSAnLi9Db25zdHJ1Y3RzL05vdGlmeUxpa2VkJztcbmltcG9ydCB7IE5vdGlmeU1lbnRpb24gfSBmcm9tICcuL0NvbnN0cnVjdHMvTm90aWZ5TWVudGlvbic7XG5pbXBvcnQgeyBOb3RpZnlSZXBsaWVkIH0gZnJvbSAnLi9Db25zdHJ1Y3RzL05vdGlmeVJlcGxpZWQnO1xuaW1wb3J0IHsgU2VuZERpcmVjdE1lc3NhZ2UgfSBmcm9tICcuL0NvbnN0cnVjdHMvU2VuZERpcmVjdE1lc3NhZ2UnO1xuaW1wb3J0IHsgT3RoZXJVc2VyQ29udmVyc2F0aW9uIH0gZnJvbSAnLi9Db25zdHJ1Y3RzL05lc3RlZE90aGVyVXNlckNvbnZlcnNhdGlvbkNvbnN0cnVjdCc7XG5leHBvcnQgY2xhc3MgQXBpU3RhY2sgZXh0ZW5kcyBjZGsuU3RhY2sge1xuICBwdWJsaWMgYXBpOiBhcHBzeW5jLkdyYXBocWxBcGk7XG4gIHB1YmxpYyBwcm9wczogQXBpU3RhY2tQcm9wcztcbiAgcHVibGljIGltYWdlVXBsb2FkRnVuY3Rpb246IGNkay5hd3NfbGFtYmRhX25vZGVqcy5Ob2RlanNGdW5jdGlvbjtcbiAgcHVibGljIHR3ZWV0RnVuY3Rpb246IGNkay5hd3NfbGFtYmRhX25vZGVqcy5Ob2RlanNGdW5jdGlvbjtcblxuICBjb25zdHJ1Y3RvcihzY29wZTogQ29uc3RydWN0LCBpZDogc3RyaW5nLCBwcm9wczogQXBpU3RhY2tQcm9wcykge1xuICAgIHN1cGVyKHNjb3BlLCBpZCwgcHJvcHMpO1xuICAgIHRoaXMuYXBpID0gbmV3IGFwcHN5bmMuR3JhcGhxbEFwaSh0aGlzLCAnQXBpJywge1xuICAgICAgbmFtZTogJ3R3aXR0ZXItYXBpJyxcbiAgICAgIHNjaGVtYTogYXBwc3luYy5TY2hlbWEuZnJvbUFzc2V0KFxuICAgICAgICBwYXRoLmpvaW4oX19kaXJuYW1lLCAnU2NoZW1hL3NjaGVtYS5hcGkuZ3JhcGhxbCcpXG4gICAgICApLFxuICAgICAgYXV0aG9yaXphdGlvbkNvbmZpZzoge1xuICAgICAgICBkZWZhdWx0QXV0aG9yaXphdGlvbjoge1xuICAgICAgICAgIGF1dGhvcml6YXRpb25UeXBlOiBhcHBzeW5jLkF1dGhvcml6YXRpb25UeXBlLlVTRVJfUE9PTCxcbiAgICAgICAgICB1c2VyUG9vbENvbmZpZzoge1xuICAgICAgICAgICAgdXNlclBvb2w6IHByb3BzLnVzZXJQb29sXG4gICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICAvLyBhZGRpdGlvbmFsIGlhbSBhdXRoXG4gICAgICAgIGFkZGl0aW9uYWxBdXRob3JpemF0aW9uTW9kZXM6IFtcbiAgICAgICAgICB7XG4gICAgICAgICAgICBhdXRob3JpemF0aW9uVHlwZTogYXBwc3luYy5BdXRob3JpemF0aW9uVHlwZS5JQU1cbiAgICAgICAgICB9XG4gICAgICAgIF1cbiAgICAgIH1cbiAgICB9KTtcbiAgICB0aGlzLnByb3BzID0gcHJvcHM7XG4gICAgdGhpcy5xdWVyaWVzKCk7XG4gICAgdGhpcy5tdXRhdGlvbnMoKTtcbiAgICB0aGlzLm5lc3RlZFJlc29sdmVycygpO1xuICAgIHRoaXMuc3Vic2NyaXB0aW9ucygpO1xuXG4gICAgLy9vdXRwdXQgQVBJIFVSTFxuICAgIG5ldyBjZGsuQ2ZuT3V0cHV0KHRoaXMsICdHcmFwaFFMQVBJVVJMJywge1xuICAgICAgdmFsdWU6IHRoaXMuYXBpLmdyYXBocWxVcmxcbiAgICB9KTtcbiAgfVxuXG4gIHB1YmxpYyBxdWVyaWVzKCkge1xuICAgIG5ldyBHZXRNeVByb2ZpbGVSZXNvbHZlcihcbiAgICAgIHRoaXMsXG4gICAgICAnUXVlcnlHZXRNeVByb2ZpbGVSZXNvbHZlcicsXG4gICAgICB0aGlzLmFwaSxcbiAgICAgIHRoaXMucHJvcHMudXNlcnNUYWJsZVxuICAgICkucmVzb2x2ZXI7XG5cbiAgICBjb25zdCBnZXRJbWFnZVVwbG9hZFVybCA9IG5ldyBHZXRJbWFnZVVwbG9hZFVSTChcbiAgICAgIHRoaXMsXG4gICAgICAnUXVlcnlHZXRJbWFnZVVwbG9hZFVybCcsXG4gICAgICB0aGlzLmFwaVxuICAgICk7XG4gICAgZ2V0SW1hZ2VVcGxvYWRVcmwucmVzb2x2ZXI7XG4gICAgdGhpcy5pbWFnZVVwbG9hZEZ1bmN0aW9uID0gZ2V0SW1hZ2VVcGxvYWRVcmwuZ2V0SW1hZ2VVcGxvYWRVUkxmdW5jdGlvbjtcblxuICAgIG5ldyBHZXRUd2VldHNSZXNvbHZlcihcbiAgICAgIHRoaXMsXG4gICAgICAnUXVlcnlHZXRUd2VldHNSZXNvbHZlcicsXG4gICAgICB0aGlzLmFwaSxcbiAgICAgIHRoaXMucHJvcHMudHdlZXRzVGFibGVcbiAgICApLnJlc29sdmVyO1xuXG4gICAgbmV3IEdldE15VGltZUxpbmUoXG4gICAgICB0aGlzLFxuICAgICAgJ1F1ZXJ5R2V0TXlUaW1lTGluZVJlc29sdmVyJyxcbiAgICAgIHRoaXMuYXBpLFxuICAgICAgdGhpcy5wcm9wcy50aW1lbGluZXNUYWJsZVxuICAgICkucmVzb2x2ZXI7XG5cbiAgICBuZXcgR2V0TGlrZXModGhpcywgJ1F1ZXJ5R2V0TGlrZXNSZXNvbHZlcicsIHRoaXMuYXBpLCB0aGlzLnByb3BzLmxpa2VzVGFibGUpXG4gICAgICAucmVzb2x2ZXI7XG5cbiAgICBuZXcgR2V0UHJvZmlsZSh0aGlzLCAnUXVlcnlHZXRQcm9maWxlJywgdGhpcy5hcGksIHRoaXMucHJvcHMudXNlcnNUYWJsZSlcbiAgICAgIC5yZXNvbHZlcjtcblxuICAgIC8vIFRoaXMgaXMgcGlwZWxpbmUgcmVzb2x2ZXIgZXhhbXBsZVxuICAgIG5ldyBHZXRGb2xsb3dlcnMoXG4gICAgICB0aGlzLFxuICAgICAgJ1F1ZXJ5R2V0Rm9sbG93ZXJzJyxcbiAgICAgIHRoaXMuYXBpLFxuICAgICAgdGhpcy5wcm9wcy5yZWxhdGlvbnNoaXBzVGFibGUsXG4gICAgICB0aGlzLnByb3BzLnVzZXJzVGFibGVcbiAgICApLnJlc29sdmVyO1xuXG4gICAgbmV3IEdldEZvbGxvd2luZyhcbiAgICAgIHRoaXMsXG4gICAgICAnUXVlcnlHZXRGb2xsb3dpbmcnLFxuICAgICAgdGhpcy5hcGksXG4gICAgICB0aGlzLnByb3BzLnJlbGF0aW9uc2hpcHNUYWJsZSxcbiAgICAgIHRoaXMucHJvcHMudXNlcnNUYWJsZVxuICAgICkucmVzb2x2ZXI7XG5cbiAgICBuZXcgU2VhcmNoKHRoaXMsICdRdWVyeVNlYXJjaCcsIHRoaXMuYXBpKS5yZXNvbHZlcjtcbiAgICBuZXcgSGFzaHRhZyh0aGlzLCAnUXVlcnlIYXNodGFnJywgdGhpcy5hcGkpLnJlc29sdmVyO1xuICB9XG5cbiAgcHVibGljIG5lc3RlZFJlc29sdmVycygpIHtcbiAgICBuZXcgTmVzdGVkUHJvZmlsZVR3ZWV0KFxuICAgICAgdGhpcyxcbiAgICAgICdOZXN0ZWRQcm9maWxlVHdlZXQnLFxuICAgICAgdGhpcy5hcGksXG4gICAgICB0aGlzLnByb3BzLnVzZXJzVGFibGVcbiAgICApLnJlc29sdmVyO1xuXG4gICAgbmV3IE5lc3RlZFVuaHlkcmF0ZWRUd2VldHNQYWdlKFxuICAgICAgdGhpcyxcbiAgICAgICdOZXN0ZWRVbmh5ZHJhdGVkVHdlZXRzUGFnZScsXG4gICAgICB0aGlzLmFwaSxcbiAgICAgIHRoaXMucHJvcHMudHdlZXRzVGFibGVcbiAgICApLnJlc29sdmVyO1xuXG4gICAgbmV3IE5lc3RlZExpa2VkKHRoaXMsICdOZXN0ZWRMaWtlZCcsIHRoaXMuYXBpLCB0aGlzLnByb3BzLmxpa2VzVGFibGUpXG4gICAgICAucmVzb2x2ZXI7XG4gICAgbmV3IE5lc3RlZE15UHJvZmlsZShcbiAgICAgIHRoaXMsXG4gICAgICAnTmVzdGVkTXlQcm9maWxlJyxcbiAgICAgIHRoaXMuYXBpLFxuICAgICAgdGhpcy5wcm9wcy50d2VldHNUYWJsZVxuICAgICkucmVzb2x2ZXI7XG5cbiAgICBuZXcgTmVzdGVkT3RoZXJQcm9maWxlKFxuICAgICAgdGhpcyxcbiAgICAgICdOZXN0ZWRPdGhlclByb2ZpbGUnLFxuICAgICAgdGhpcy5hcGksXG4gICAgICB0aGlzLnByb3BzLnR3ZWV0c1RhYmxlXG4gICAgKS5yZXNvbHZlcjtcblxuICAgIG5ldyBOZXN0ZWRSZXR3ZWV0UHJvZmlsZShcbiAgICAgIHRoaXMsXG4gICAgICAnTmVzdGVkUmV0d2VldFByb2ZpbGUnLFxuICAgICAgdGhpcy5hcGksXG4gICAgICB0aGlzLnByb3BzLnVzZXJzVGFibGVcbiAgICApLnJlc29sdmVyO1xuXG4gICAgbmV3IE5lc3RlZFJldHdlZXRPZihcbiAgICAgIHRoaXMsXG4gICAgICAnTmVzdGVkUmV0d2VldE9mJyxcbiAgICAgIHRoaXMuYXBpLFxuICAgICAgdGhpcy5wcm9wcy50d2VldHNUYWJsZVxuICAgICkucmVzb2x2ZXI7XG5cbiAgICBuZXcgTmVzdGVkVHdlZXRSZXR3ZWV0ZWQoXG4gICAgICB0aGlzLFxuICAgICAgJ05lc3RlZFR3ZWV0UmV0d2VldGVkJyxcbiAgICAgIHRoaXMuYXBpLFxuICAgICAgdGhpcy5wcm9wcy5yZXR3ZWV0c1RhYmxlXG4gICAgKS5yZXNvbHZlcjtcblxuICAgIG5ldyBOZXN0ZWRSZXBseVByb2ZpbGUoXG4gICAgICB0aGlzLFxuICAgICAgJ05lc3RlZFJlcGx5UHJvZmlsZScsXG4gICAgICB0aGlzLmFwaSxcbiAgICAgIHRoaXMucHJvcHMudXNlcnNUYWJsZVxuICAgICkucmVzb2x2ZXI7XG5cbiAgICBuZXcgTmVzdGVkSW5SZXBseVRvVHdlZXQoXG4gICAgICB0aGlzLFxuICAgICAgJ05lc3RlZEluUmVwbHlUb1R3ZWV0JyxcbiAgICAgIHRoaXMuYXBpLFxuICAgICAgdGhpcy5wcm9wcy50d2VldHNUYWJsZVxuICAgICkucmVzb2x2ZXI7XG5cbiAgICBuZXcgTmVzdGVkSW5SZXBseVRvVXNlcnMoXG4gICAgICB0aGlzLFxuICAgICAgJ05lc3RlZEluUmVwbHlUb1VzZXJzJyxcbiAgICAgIHRoaXMuYXBpLFxuICAgICAgdGhpcy5wcm9wcy51c2Vyc1RhYmxlXG4gICAgKS5yZXNvbHZlcjtcblxuICAgIG5ldyBOZXN0ZWRSZXBseVJldHdlZXRlZChcbiAgICAgIHRoaXMsXG4gICAgICAnTmVzdGVkUmVwbHlSZXR3ZWV0ZWQnLFxuICAgICAgdGhpcy5hcGksXG4gICAgICB0aGlzLnByb3BzLnJldHdlZXRzVGFibGVcbiAgICApLnJlc29sdmVyO1xuXG4gICAgbmV3IE5lc3RlZFJlcGx5TGlrZShcbiAgICAgIHRoaXMsXG4gICAgICAnTmVzdGVkUmVwbHlMaWtlJyxcbiAgICAgIHRoaXMuYXBpLFxuICAgICAgdGhpcy5wcm9wcy5saWtlc1RhYmxlXG4gICAgKS5yZXNvbHZlcjtcblxuICAgIG5ldyBOZXN0ZWRGb2xsb3dpbmdPdGhlclByb2ZpbGUoXG4gICAgICB0aGlzLFxuICAgICAgJ05lc3RlZEZvbGxvd2luZ090aGVyUHJvZmlsZScsXG4gICAgICB0aGlzLmFwaSxcbiAgICAgIHRoaXMucHJvcHMucmVsYXRpb25zaGlwc1RhYmxlXG4gICAgKS5yZXNvbHZlcjtcblxuICAgIG5ldyBOZXN0ZWRGb2xsb3dlZEJ5T3RoZXJQcm9maWxlKFxuICAgICAgdGhpcyxcbiAgICAgICdOZXN0ZWRGb2xsb3dlZEJ5T3RoZXJQcm9maWxlJyxcbiAgICAgIHRoaXMuYXBpLFxuICAgICAgdGhpcy5wcm9wcy5yZWxhdGlvbnNoaXBzVGFibGVcbiAgICApLnJlc29sdmVyO1xuXG4gICAgbmV3IE90aGVyVXNlckNvbnZlcnNhdGlvbihcbiAgICAgIHRoaXMsXG4gICAgICAnT3RoZXJVc2VyQ29udmVyc2F0aW9uJyxcbiAgICAgIHRoaXMuYXBpLFxuICAgICAgdGhpcy5wcm9wcy51c2Vyc1RhYmxlXG4gICAgKS5yZXNvbHZlcjtcbiAgfVxuXG4gIC8vIGlkIHN0cmluZyBzaG91bGQgYmUgdW5pcXVlIGZvciBlYWNoIGNvbnN0cnVjdFxuICBwdWJsaWMgbXV0YXRpb25zKCkge1xuICAgIG5ldyBFZGl0TXlQcm9maWxlKFxuICAgICAgdGhpcyxcbiAgICAgICdFZGl0TXlQcm9maWxlUmVzb2x2ZXInLFxuICAgICAgdGhpcy5hcGksXG4gICAgICB0aGlzLnByb3BzLnVzZXJzVGFibGVcbiAgICApLnJlc29sdmVyO1xuXG4gICAgLy9Ud2VldCBNdXRhdGlvblxuICAgIGNvbnN0IHR3ZWV0TXV0YXRpb24gPSBuZXcgVHdlZXQodGhpcywgJ1R3ZWV0TXV0YXRpb24nLCB0aGlzLmFwaSk7XG4gICAgdHdlZXRNdXRhdGlvbi5yZXNvbHZlcjtcbiAgICB0aGlzLnByb3BzLnVzZXJzVGFibGUuZ3JhbnRGdWxsQWNjZXNzKHR3ZWV0TXV0YXRpb24uVHdlZXRmdW5jdGlvbik7XG4gICAgdGhpcy5wcm9wcy50d2VldHNUYWJsZS5ncmFudEZ1bGxBY2Nlc3ModHdlZXRNdXRhdGlvbi5Ud2VldGZ1bmN0aW9uKTtcbiAgICB0aGlzLnByb3BzLnRpbWVsaW5lc1RhYmxlLmdyYW50RnVsbEFjY2Vzcyh0d2VldE11dGF0aW9uLlR3ZWV0ZnVuY3Rpb24pO1xuXG4gICAgLy9SZXR3ZWV0TXV0YXRpb25cbiAgICBjb25zdCByZXR3ZWV0TXV0YXRpb24gPSBuZXcgUmV0d2VldCh0aGlzLCAnUmV0d2VldE11dGF0aW9uJywgdGhpcy5hcGkpO1xuICAgIHJldHdlZXRNdXRhdGlvbi5yZXNvbHZlcjtcbiAgICB0aGlzLnByb3BzLnVzZXJzVGFibGUuZ3JhbnRGdWxsQWNjZXNzKHJldHdlZXRNdXRhdGlvbi5SZXR3ZWV0ZnVuY3Rpb24pO1xuICAgIHRoaXMucHJvcHMudHdlZXRzVGFibGUuZ3JhbnRGdWxsQWNjZXNzKHJldHdlZXRNdXRhdGlvbi5SZXR3ZWV0ZnVuY3Rpb24pO1xuICAgIHRoaXMucHJvcHMudGltZWxpbmVzVGFibGUuZ3JhbnRGdWxsQWNjZXNzKHJldHdlZXRNdXRhdGlvbi5SZXR3ZWV0ZnVuY3Rpb24pO1xuICAgIHRoaXMucHJvcHMucmV0d2VldHNUYWJsZS5ncmFudEZ1bGxBY2Nlc3MocmV0d2VldE11dGF0aW9uLlJldHdlZXRmdW5jdGlvbik7XG5cbiAgICAvL1VuUmV0d2VldE11dGF0aW9uXG4gICAgY29uc3QgdW5yZXR3ZWV0TXV0YXRpb24gPSBuZXcgVW5SZXR3ZWV0KFxuICAgICAgdGhpcyxcbiAgICAgICdVblJldHdlZXRNdXRhdGlvbicsXG4gICAgICB0aGlzLmFwaVxuICAgICk7XG4gICAgdW5yZXR3ZWV0TXV0YXRpb24ucmVzb2x2ZXI7XG4gICAgdGhpcy5wcm9wcy51c2Vyc1RhYmxlLmdyYW50RnVsbEFjY2Vzcyh1bnJldHdlZXRNdXRhdGlvbi5VblJldHdlZXRGdW5jdGlvbik7XG4gICAgdGhpcy5wcm9wcy50d2VldHNUYWJsZS5ncmFudEZ1bGxBY2Nlc3ModW5yZXR3ZWV0TXV0YXRpb24uVW5SZXR3ZWV0RnVuY3Rpb24pO1xuICAgIHRoaXMucHJvcHMudGltZWxpbmVzVGFibGUuZ3JhbnRGdWxsQWNjZXNzKFxuICAgICAgdW5yZXR3ZWV0TXV0YXRpb24uVW5SZXR3ZWV0RnVuY3Rpb25cbiAgICApO1xuICAgIHRoaXMucHJvcHMucmV0d2VldHNUYWJsZS5ncmFudEZ1bGxBY2Nlc3MoXG4gICAgICB1bnJldHdlZXRNdXRhdGlvbi5VblJldHdlZXRGdW5jdGlvblxuICAgICk7XG5cbiAgICAvL1JlcGx5TXV0YXRpb25cbiAgICBjb25zdCByZXBseU11dGF0aW9uID0gbmV3IFJlcGx5KHRoaXMsICdSZXBseU11dGF0aW9uJywgdGhpcy5hcGkpO1xuICAgIHJlcGx5TXV0YXRpb24ucmVzb2x2ZXI7XG4gICAgdGhpcy5wcm9wcy51c2Vyc1RhYmxlLmdyYW50RnVsbEFjY2VzcyhyZXBseU11dGF0aW9uLlJlcGx5ZnVuY3Rpb24pO1xuICAgIHRoaXMucHJvcHMudHdlZXRzVGFibGUuZ3JhbnRGdWxsQWNjZXNzKHJlcGx5TXV0YXRpb24uUmVwbHlmdW5jdGlvbik7XG4gICAgdGhpcy5wcm9wcy50aW1lbGluZXNUYWJsZS5ncmFudEZ1bGxBY2Nlc3MocmVwbHlNdXRhdGlvbi5SZXBseWZ1bmN0aW9uKTtcblxuICAgIC8vTGlrZSBNdXRhdGlvblxuICAgIC8vIE1hbnVhbGx5IGhhdmUgdG8gYWRkIGFjY2VzcyBpbiB0aGUgc2VydmljZSByb2xlIGZyb20gY29uc29sZSBmb3IgdHdlZXRzIGFuZCB1c2VycyB0YWJsZVxuICAgIGNvbnN0IExpa2VNdXRhdGlvbiA9IG5ldyBMaWtlKFxuICAgICAgdGhpcyxcbiAgICAgICdMaWtlTXV0YXRpb24nLFxuICAgICAgdGhpcy5hcGksXG4gICAgICB0aGlzLnByb3BzLmxpa2VzVGFibGVcbiAgICApO1xuICAgIExpa2VNdXRhdGlvbi5yZXNvbHZlcjtcblxuICAgIC8vVW5saWtlIE11dGF0aW9uXG4gICAgLy8gTWFudWFsbHkgaGF2ZSB0byBhZGQgYWNjZXNzIGluIHRoZSBzZXJ2aWNlIHJvbGUgZnJvbSBjb25zb2xlIGZvciB0d2VldHMgYW5kIHVzZXJzIHRhYmxlXG5cbiAgICBjb25zdCBVbmxpa2VNdXRhdGlvbiA9IG5ldyBVbmxpa2UoXG4gICAgICB0aGlzLFxuICAgICAgJ1VubGlrZU11dGF0aW9uJyxcbiAgICAgIHRoaXMuYXBpLFxuICAgICAgdGhpcy5wcm9wcy5saWtlc1RhYmxlXG4gICAgKTtcbiAgICBVbmxpa2VNdXRhdGlvbi5yZXNvbHZlcjtcblxuICAgIC8vRm9sbG93IE11dGF0aW9uXG4gICAgLy8gTWFudWFsbHkgYWRkIGFjY2VzcyBpbiB0aGUgc2VydmljZSByb2xlIGZyb20gY29uc29sZSBmb3IgdXNlcnMgdGFibGVcbiAgICBjb25zdCBGb2xsb3dNdXRhdGlvbiA9IG5ldyBGb2xsb3coXG4gICAgICB0aGlzLFxuICAgICAgJ0ZvbGxvd011dGF0aW9uJyxcbiAgICAgIHRoaXMuYXBpLFxuICAgICAgdGhpcy5wcm9wcy5yZWxhdGlvbnNoaXBzVGFibGVcbiAgICApLnJlc29sdmVyO1xuXG4gICAgLy9VbmZvbGxvdyBNdXRhdGlvblxuICAgIC8vIE1hbnVhbGx5IGFkZCBhY2Nlc3MgaW4gdGhlIHNlcnZpY2Ugcm9sZSBmcm9tIGNvbnNvbGUgZm9yIHVzZXJzIHRhYmxlXG4gICAgY29uc3QgVW5mb2xsb3dNdXRhdGlvbiA9IG5ldyBVbkZvbGxvdyhcbiAgICAgIHRoaXMsXG4gICAgICAnVW5mb2xsb3dNdXRhdGlvbicsXG4gICAgICB0aGlzLmFwaSxcbiAgICAgIHRoaXMucHJvcHMucmVsYXRpb25zaGlwc1RhYmxlXG4gICAgKS5yZXNvbHZlcjtcblxuICAgIG5ldyBOb3RpZnlSZXR3ZWV0ZWQoXG4gICAgICB0aGlzLFxuICAgICAgJ05vdGlmeVJldHdlZXRlZCcsXG4gICAgICB0aGlzLmFwaSxcbiAgICAgIHRoaXMucHJvcHMubm90aWZpY2F0aW9uc1RhYmxlXG4gICAgKTtcblxuICAgIG5ldyBOb3RpZnlMaWtlZChcbiAgICAgIHRoaXMsXG4gICAgICAnTm90aWZ5TGlrZWQnLFxuICAgICAgdGhpcy5hcGksXG4gICAgICB0aGlzLnByb3BzLm5vdGlmaWNhdGlvbnNUYWJsZVxuICAgICk7XG5cbiAgICBuZXcgTm90aWZ5TWVudGlvbihcbiAgICAgIHRoaXMsXG4gICAgICAnTm90aWZ5TWVudGlvbicsXG4gICAgICB0aGlzLmFwaSxcbiAgICAgIHRoaXMucHJvcHMubm90aWZpY2F0aW9uc1RhYmxlXG4gICAgKTtcblxuICAgIG5ldyBOb3RpZnlSZXBsaWVkKFxuICAgICAgdGhpcyxcbiAgICAgICdOb3RpZnlSZXBsaWVkJyxcbiAgICAgIHRoaXMuYXBpLFxuICAgICAgdGhpcy5wcm9wcy5ub3RpZmljYXRpb25zVGFibGVcbiAgICApO1xuXG4gICAgY29uc3Qgc2VuZERpcmVjdE1lc3NhZ2VNdXRhdGlvbiA9IG5ldyBTZW5kRGlyZWN0TWVzc2FnZShcbiAgICAgIHRoaXMsXG4gICAgICAnU2VuZERpcmVjdE1lc3NhZ2VNdXRhdGlvbicsXG4gICAgICB0aGlzLmFwaVxuICAgICk7XG4gICAgc2VuZERpcmVjdE1lc3NhZ2VNdXRhdGlvbi5yZXNvbHZlcjtcbiAgICB0aGlzLnByb3BzLmNvbnZlcnNhdGlvbnNUYWJsZS5ncmFudEZ1bGxBY2Nlc3MoXG4gICAgICBzZW5kRGlyZWN0TWVzc2FnZU11dGF0aW9uLlNlbmREaXJlY3RNZXNzYWdlZnVuY3Rpb25cbiAgICApO1xuICAgIHRoaXMucHJvcHMuZGlyZWN0TWVzc2FnZXNUYWJsZS5ncmFudEZ1bGxBY2Nlc3MoXG4gICAgICBzZW5kRGlyZWN0TWVzc2FnZU11dGF0aW9uLlNlbmREaXJlY3RNZXNzYWdlZnVuY3Rpb25cbiAgICApO1xuICB9XG5cbiAgcHVibGljIHN1YnNjcmlwdGlvbnMoKSB7XG4gICAgbmV3IE9uTm90aWZpZWQodGhpcywgJ09uTm90aWZpZWRTdWJzY3JpcHRpb24nLCB0aGlzLmFwaSk7XG4gIH1cbn1cbiJdfQ==
"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.ApiStack = void 0;
const GetFollowingConstruct_1 = require("./Constructs/GetFollowingConstruct");
const UnfollowConstruct_1 = require("./Constructs/UnfollowConstruct");
const NestedFollowingProfie_1 = require("./Constructs/NestedFollowingProfie");
const NestedInReplyToUsers_1 = require("./Constructs/NestedInReplyToUsers");
const NestedInReplToTweet_1 = require("./Constructs/NestedInReplToTweet");
const NestedReplyProfile_1 = require("./Constructs/NestedReplyProfile");
const ReplyConstruct_1 = require("./Constructs/ReplyConstruct");
const NestedTweetRetweeted_1 = require("./Constructs/NestedTweetRetweeted");
const NestedRetweetOf_1 = require("./Constructs/NestedRetweetOf");
const Nested_RetweetProfile_1 = require("./Constructs/Nested_RetweetProfile");
const RetweetConstruct_1 = require("./Constructs/RetweetConstruct");
const Nested_OtherProfileTweet_1 = require("./Constructs/Nested_OtherProfileTweet");
const Nested_MyProfileTweet_1 = require("./Constructs/Nested_MyProfileTweet");
const GetLikesConstruct_1 = require("./Constructs/GetLikesConstruct");
const UnlikeConstruct_1 = require("./Constructs/UnlikeConstruct");
const NestedLiked_1 = require("./Constructs/NestedLiked");
const LikeContruct_1 = require("./Constructs/LikeContruct");
const NestedUnhydratedTweets_1 = require("./Constructs/NestedUnhydratedTweets");
const GetMyTimeLine_1 = require("./Constructs/GetMyTimeLine");
const TweetConstruct_1 = require("./Constructs/TweetConstruct");
const GetMyProfileConstruct_1 = require("./Constructs/GetMyProfileConstruct");
const cdk = require("aws-cdk-lib");
const appsync = require("@aws-cdk/aws-appsync-alpha");
const path = require("path");
const EditMyProfileConstruct_1 = require("./Constructs/EditMyProfileConstruct");
const GetImageUploadUrlConstruct_1 = require("./Constructs/GetImageUploadUrlConstruct");
const GetTweetsConstuct_1 = require("./Constructs/GetTweetsConstuct");
const NestedProfile_Type_Tweet_1 = require("./Constructs/NestedProfile_Type_Tweet");
const UnRetweetConstruct_1 = require("./Constructs/UnRetweetConstruct");
const NestedReplyRetweeted_1 = require("./Constructs/NestedReplyRetweeted");
const NestedReplyLike_1 = require("./Constructs/NestedReplyLike");
const FollowConstruct_1 = require("./Constructs/FollowConstruct");
const NestedFollowedByProfile_1 = require("./Constructs/NestedFollowedByProfile");
const GetProfileConstruct_1 = require("./Constructs/GetProfileConstruct");
const GetFollowersConstruct_1 = require("./Constructs/GetFollowersConstruct");
class ApiStack extends cdk.Stack {
    constructor(scope, id, props) {
        super(scope, id, props);
        this.api = new appsync.GraphqlApi(this, 'Api', {
            name: 'twitter-api',
            schema: appsync.Schema.fromAsset(path.join(__dirname, 'Schema/schema.api.graphql')),
            authorizationConfig: {
                defaultAuthorization: {
                    authorizationType: appsync.AuthorizationType.USER_POOL,
                    userPoolConfig: {
                        userPool: props.userPool
                    }
                }
            },
        });
        this.props = props;
        this.queries();
        this.mutations();
        this.nestedResolvers();
        //output API URL
        new cdk.CfnOutput(this, 'GraphQLAPIURL', {
            value: this.api.graphqlUrl
        });
    }
    queries() {
        new GetMyProfileConstruct_1.GetMyProfileResolver(this, 'QueryGetMyProfileResolver', this.api, this.props.usersTable).resolver;
        const getImageUploadUrl = new GetImageUploadUrlConstruct_1.GetImageUploadURL(this, 'QueryGetImageUploadUrl', this.api);
        getImageUploadUrl.resolver;
        this.imageUploadFunction = getImageUploadUrl.getImageUploadURLfunction;
        new GetTweetsConstuct_1.GetTweetsResolver(this, 'QueryGetTweetsResolver', this.api, this.props.tweetsTable).resolver;
        new GetMyTimeLine_1.GetMyTimeLine(this, 'QueryGetMyTimeLineResolver', this.api, this.props.timelinesTable).resolver;
        new GetLikesConstruct_1.GetLikes(this, 'QueryGetLikesResolver', this.api, this.props.likesTable)
            .resolver;
        new GetProfileConstruct_1.GetProfile(this, 'QueryGetProfile', this.api, this.props.usersTable)
            .resolver;
        // This is pipeline resolver example
        new GetFollowersConstruct_1.GetFollowers(this, 'QueryGetFollowers', this.api, this.props.relationshipsTable, this.props.usersTable).resolver;
        new GetFollowingConstruct_1.GetFollowing(this, 'QueryGetFollowing', this.api, this.props.relationshipsTable, this.props.usersTable).resolver;
    }
    nestedResolvers() {
        new NestedProfile_Type_Tweet_1.NestedProfileTweet(this, 'NestedProfileTweet', this.api, this.props.usersTable).resolver;
        new NestedUnhydratedTweets_1.NestedUnhydratedTweetsPage(this, 'NestedUnhydratedTweetsPage', this.api, this.props.tweetsTable).resolver;
        new NestedLiked_1.NestedLiked(this, 'NestedLiked', this.api, this.props.likesTable)
            .resolver;
        new Nested_MyProfileTweet_1.NestedMyProfile(this, 'NestedMyProfile', this.api, this.props.tweetsTable).resolver;
        new Nested_OtherProfileTweet_1.NestedOtherProfile(this, 'NestedOtherProfile', this.api, this.props.tweetsTable).resolver;
        new Nested_RetweetProfile_1.NestedRetweetProfile(this, 'NestedRetweetProfile', this.api, this.props.usersTable).resolver;
        new NestedRetweetOf_1.NestedRetweetOf(this, 'NestedRetweetOf', this.api, this.props.tweetsTable).resolver;
        new NestedTweetRetweeted_1.NestedTweetRetweeted(this, 'NestedTweetRetweeted', this.api, this.props.retweetsTable).resolver;
        new NestedReplyProfile_1.NestedReplyProfile(this, 'NestedReplyProfile', this.api, this.props.usersTable).resolver;
        new NestedInReplToTweet_1.NestedInReplyToTweet(this, 'NestedInReplyToTweet', this.api, this.props.tweetsTable).resolver;
        new NestedInReplyToUsers_1.NestedInReplyToUsers(this, 'NestedInReplyToUsers', this.api, this.props.usersTable).resolver;
        new NestedReplyRetweeted_1.NestedReplyRetweeted(this, 'NestedReplyRetweeted', this.api, this.props.retweetsTable).resolver;
        new NestedReplyLike_1.NestedReplyLike(this, 'NestedReplyLike', this.api, this.props.likesTable).resolver;
        new NestedFollowingProfie_1.NestedFollowingOtherProfile(this, 'NestedFollowingOtherProfile', this.api, this.props.relationshipsTable).resolver;
        new NestedFollowedByProfile_1.NestedFollowedByOtherProfile(this, 'NestedFollowedByOtherProfile', this.api, this.props.relationshipsTable).resolver;
    }
    // id string should be unique for each construct
    mutations() {
        new EditMyProfileConstruct_1.EditMyProfile(this, 'EditMyProfileResolver', this.api, this.props.usersTable).resolver;
        //Tweet Mutation
        const tweetMutation = new TweetConstruct_1.Tweet(this, 'TweetMutation', this.api);
        tweetMutation.resolver;
        this.props.usersTable.grantFullAccess(tweetMutation.Tweetfunction);
        this.props.tweetsTable.grantFullAccess(tweetMutation.Tweetfunction);
        this.props.timelinesTable.grantFullAccess(tweetMutation.Tweetfunction);
        //RetweetMutation
        const retweetMutation = new RetweetConstruct_1.Retweet(this, 'RetweetMutation', this.api);
        retweetMutation.resolver;
        this.props.usersTable.grantFullAccess(retweetMutation.Retweetfunction);
        this.props.tweetsTable.grantFullAccess(retweetMutation.Retweetfunction);
        this.props.timelinesTable.grantFullAccess(retweetMutation.Retweetfunction);
        this.props.retweetsTable.grantFullAccess(retweetMutation.Retweetfunction);
        //UnRetweetMutation
        const unretweetMutation = new UnRetweetConstruct_1.UnRetweet(this, 'UnRetweetMutation', this.api);
        unretweetMutation.resolver;
        this.props.usersTable.grantFullAccess(unretweetMutation.UnRetweetFunction);
        this.props.tweetsTable.grantFullAccess(unretweetMutation.UnRetweetFunction);
        this.props.timelinesTable.grantFullAccess(unretweetMutation.UnRetweetFunction);
        this.props.retweetsTable.grantFullAccess(unretweetMutation.UnRetweetFunction);
        //ReplyMutation
        const replyMutation = new ReplyConstruct_1.Reply(this, 'ReplyMutation', this.api);
        replyMutation.resolver;
        this.props.usersTable.grantFullAccess(replyMutation.Replyfunction);
        this.props.tweetsTable.grantFullAccess(replyMutation.Replyfunction);
        this.props.timelinesTable.grantFullAccess(replyMutation.Replyfunction);
        //Like Mutation
        // Manually have to add access in the service role from console for tweets and users table
        const LikeMutation = new LikeContruct_1.Like(this, 'LikeMutation', this.api, this.props.likesTable);
        LikeMutation.resolver;
        //Unlike Mutation
        // Manually have to add access in the service role from console for tweets and users table
        const UnlikeMutation = new UnlikeConstruct_1.Unlike(this, 'UnlikeMutation', this.api, this.props.likesTable);
        UnlikeMutation.resolver;
        //Follow Mutation
        // Manually add access in the service role from console for users table
        const FollowMutation = new FollowConstruct_1.Follow(this, 'FollowMutation', this.api, this.props.relationshipsTable).resolver;
        //Unfollow Mutation
        // Manually add access in the service role from console for users table
        const UnfollowMutation = new UnfollowConstruct_1.UnFollow(this, 'UnfollowMutation', this.api, this.props.relationshipsTable).resolver;
    }
}
exports.ApiStack = ApiStack;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiYXBpLXN0YWNrLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiYXBpLXN0YWNrLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7OztBQUFBLDhFQUFrRTtBQUNsRSxzRUFBMEQ7QUFDMUQsOEVBQWlGO0FBQ2pGLDRFQUF5RTtBQUN6RSwwRUFBd0U7QUFDeEUsd0VBQXFFO0FBQ3JFLGdFQUFvRDtBQUNwRCw0RUFBeUU7QUFDekUsa0VBQStEO0FBQy9ELDhFQUEwRTtBQUMxRSxvRUFBd0Q7QUFDeEQsb0ZBQTJFO0FBQzNFLDhFQUFxRTtBQUNyRSxzRUFBMEQ7QUFDMUQsa0VBQXNEO0FBQ3RELDBEQUF1RDtBQUN2RCw0REFBaUQ7QUFDakQsZ0ZBQWlGO0FBQ2pGLDhEQUEyRDtBQUMzRCxnRUFBb0Q7QUFDcEQsOEVBQTBFO0FBRTFFLG1DQUFtQztBQUVuQyxzREFBc0Q7QUFDdEQsNkJBQTZCO0FBQzdCLGdGQUFvRTtBQUNwRSx3RkFBNEU7QUFDNUUsc0VBQW1FO0FBQ25FLG9GQUEyRTtBQUMzRSx3RUFBNEQ7QUFDNUQsNEVBQXlFO0FBQ3pFLGtFQUErRDtBQUMvRCxrRUFBc0Q7QUFDdEQsa0ZBQW9GO0FBQ3BGLDBFQUE4RDtBQUM5RCw4RUFBa0U7QUFDbEUsTUFBYSxRQUFTLFNBQVEsR0FBRyxDQUFDLEtBQUs7SUFNckMsWUFBWSxLQUFnQixFQUFFLEVBQVUsRUFBRSxLQUFvQjtRQUM1RCxLQUFLLENBQUMsS0FBSyxFQUFFLEVBQUUsRUFBRSxLQUFLLENBQUMsQ0FBQztRQUN4QixJQUFJLENBQUMsR0FBRyxHQUFHLElBQUksT0FBTyxDQUFDLFVBQVUsQ0FBQyxJQUFJLEVBQUUsS0FBSyxFQUFFO1lBQzdDLElBQUksRUFBRSxhQUFhO1lBQ25CLE1BQU0sRUFBRSxPQUFPLENBQUMsTUFBTSxDQUFDLFNBQVMsQ0FDOUIsSUFBSSxDQUFDLElBQUksQ0FBQyxTQUFTLEVBQUUsMkJBQTJCLENBQUMsQ0FDbEQ7WUFDRCxtQkFBbUIsRUFBRTtnQkFDbkIsb0JBQW9C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QztJQUNiLENBQUM7Q0FDRjtBQXJSRCw0QkFxUkMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBHZXRGb2xsb3dpbmcgfSBmcm9tICcuL0NvbnN0cnVjdHMvR2V0Rm9sbG93aW5nQ29uc3RydWN0JztcbmltcG9ydCB7IFVuRm9sbG93IH0gZnJvbSAnLi9Db25zdHJ1Y3RzL1VuZm9sbG93Q29uc3RydWN0JztcbmltcG9ydCB7IE5lc3RlZEZvbGxvd2luZ090aGVyUHJvZmlsZSB9IGZyb20gJy4vQ29uc3RydWN0cy9OZXN0ZWRGb2xsb3dpbmdQcm9maWUnO1xuaW1wb3J0IHsgTmVzdGVkSW5SZXBseVRvVXNlcnMgfSBmcm9tICcuL0NvbnN0cnVjdHMvTmVzdGVkSW5SZXBseVRvVXNlcnMnO1xuaW1wb3J0IHsgTmVzdGVkSW5SZXBseVRvVHdlZXQgfSBmcm9tICcuL0NvbnN0cnVjdHMvTmVzdGVkSW5SZXBsVG9Ud2VldCc7XG5pbXBvcnQgeyBOZXN0ZWRSZXBseVByb2ZpbGUgfSBmcm9tICcuL0NvbnN0cnVjdHMvTmVzdGVkUmVwbHlQcm9maWxlJztcbmltcG9ydCB7IFJlcGx5IH0gZnJvbSAnLi9Db25zdHJ1Y3RzL1JlcGx5Q29uc3RydWN0JztcbmltcG9ydCB7IE5lc3RlZFR3ZWV0UmV0d2VldGVkIH0gZnJvbSAnLi9Db25zdHJ1Y3RzL05lc3RlZFR3ZWV0UmV0d2VldGVkJztcbmltcG9ydCB7IE5lc3RlZFJldHdlZXRPZiB9IGZyb20gJy4vQ29uc3RydWN0cy9OZXN0ZWRSZXR3ZWV0T2YnO1xuaW1wb3J0IHsgTmVzdGVkUmV0d2VldFByb2ZpbGUgfSBmcm9tICcuL0NvbnN0cnVjdHMvTmVzdGVkX1JldHdlZXRQcm9maWxlJztcbmltcG9ydCB7IFJldHdlZXQgfSBmcm9tICcuL0NvbnN0cnVjdHMvUmV0d2VldENvbnN0cnVjdCc7XG5pbXBvcnQgeyBOZXN0ZWRPdGhlclByb2ZpbGUgfSBmcm9tICcuL0NvbnN0cnVjdHMvTmVzdGVkX090aGVyUHJvZmlsZVR3ZWV0JztcbmltcG9ydCB7IE5lc3RlZE15UHJvZmlsZSB9IGZyb20gJy4vQ29uc3RydWN0cy9OZXN0ZWRfTXlQcm9maWxlVHdlZXQnO1xuaW1wb3J0IHsgR2V0TGlrZXMgfSBmcm9tICcuL0NvbnN0cnVjdHMvR2V0TGlrZXNDb25zdHJ1Y3QnO1xuaW1wb3J0IHsgVW5saWtlIH0gZnJvbSAnLi9Db25zdHJ1Y3RzL1VubGlrZUNvbnN0cnVjdCc7XG5pbXBvcnQgeyBOZXN0ZWRMaWtlZCB9IGZyb20gJy4vQ29uc3RydWN0cy9OZXN0ZWRMaWtlZCc7XG5pbXBvcnQgeyBMaWtlIH0gZnJvbSAnLi9Db25zdHJ1Y3RzL0xpa2VDb250cnVjdCc7XG5pbXBvcnQgeyBOZXN0ZWRVbmh5ZHJhdGVkVHdlZXRzUGFnZSB9IGZyb20gJy4vQ29uc3RydWN0cy9OZXN0ZWRVbmh5ZHJhdGVkVHdlZXRzJztcbmltcG9ydCB7IEdldE15VGltZUxpbmUgfSBmcm9tICcuL0NvbnN0cnVjdHMvR2V0TXlUaW1lTGluZSc7XG5pbXBvcnQgeyBUd2VldCB9IGZyb20gJy4vQ29uc3RydWN0cy9Ud2VldENvbnN0cnVjdCc7XG5pbXBvcnQgeyBHZXRNeVByb2ZpbGVSZXNvbHZlciB9IGZyb20gJy4vQ29uc3RydWN0cy9HZXRNeVByb2ZpbGVDb25zdHJ1Y3QnO1xuaW1wb3J0IHsgQXBpU3RhY2tQcm9wcyB9IGZyb20gJy4vLi4vLi4vLi4vSW50ZXJmYWNlcy9hcGktaW50ZXJmYWNlJztcbmltcG9ydCAqIGFzIGNkayBmcm9tICdhd3MtY2RrLWxpYic7XG5pbXBvcnQgeyBDb25zdHJ1Y3QgfSBmcm9tICdjb25zdHJ1Y3RzJztcbmltcG9ydCAqIGFzIGFwcHN5bmMgZnJvbSAnQGF3cy1jZGsvYXdzLWFwcHN5bmMtYWxwaGEnO1xuaW1wb3J0ICogYXMgcGF0aCBmcm9tICdwYXRoJztcbmltcG9ydCB7IEVkaXRNeVByb2ZpbGUgfSBmcm9tICcuL0NvbnN0cnVjdHMvRWRpdE15UHJvZmlsZUNvbnN0cnVjdCc7XG5pbXBvcnQgeyBHZXRJbWFnZVVwbG9hZFVSTCB9IGZyb20gJy4vQ29uc3RydWN0cy9HZXRJbWFnZVVwbG9hZFVybENvbnN0cnVjdCc7XG5pbXBvcnQgeyBHZXRUd2VldHNSZXNvbHZlciB9IGZyb20gJy4vQ29uc3RydWN0cy9HZXRUd2VldHNDb25zdHVjdCc7XG5pbXBvcnQgeyBOZXN0ZWRQcm9maWxlVHdlZXQgfSBmcm9tICcuL0NvbnN0cnVjdHMvTmVzdGVkUHJvZmlsZV9UeXBlX1R3ZWV0JztcbmltcG9ydCB7IFVuUmV0d2VldCB9IGZyb20gJy4vQ29uc3RydWN0cy9VblJldHdlZXRDb25zdHJ1Y3QnO1xuaW1wb3J0IHsgTmVzdGVkUmVwbHlSZXR3ZWV0ZWQgfSBmcm9tICcuL0NvbnN0cnVjdHMvTmVzdGVkUmVwbHlSZXR3ZWV0ZWQnO1xuaW1wb3J0IHsgTmVzdGVkUmVwbHlMaWtlIH0gZnJvbSAnLi9Db25zdHJ1Y3RzL05lc3RlZFJlcGx5TGlrZSc7XG5pbXBvcnQgeyBGb2xsb3cgfSBmcm9tICcuL0NvbnN0cnVjdHMvRm9sbG93Q29uc3RydWN0JztcbmltcG9ydCB7IE5lc3RlZEZvbGxvd2VkQnlPdGhlclByb2ZpbGUgfSBmcm9tICcuL0NvbnN0cnVjdHMvTmVzdGVkRm9sbG93ZWRCeVByb2ZpbGUnO1xuaW1wb3J0IHsgR2V0UHJvZmlsZSB9IGZyb20gJy4vQ29uc3RydWN0cy9HZXRQcm9maWxlQ29uc3RydWN0JztcbmltcG9ydCB7IEdldEZvbGxvd2VycyB9IGZyb20gJy4vQ29uc3RydWN0cy9HZXRGb2xsb3dlcnNDb25zdHJ1Y3QnO1xuZXhwb3J0IGNsYXNzIEFwaVN0YWNrIGV4dGVuZHMgY2RrLlN0YWNrIHtcbiAgcHVibGljIGFwaTogYXBwc3luYy5HcmFwaHFsQXBpO1xuICBwdWJsaWMgcHJvcHM6IEFwaVN0YWNrUHJvcHM7XG4gIHB1YmxpYyBpbWFnZVVwbG9hZEZ1bmN0aW9uOiBjZGsuYXdzX2xhbWJkYV9ub2RlanMuTm9kZWpzRnVuY3Rpb247XG4gIHB1YmxpYyB0d2VldEZ1bmN0aW9uOiBjZGsuYXdzX2xhbWJkYV9ub2RlanMuTm9kZWpzRnVuY3Rpb247XG5cbiAgY29uc3RydWN0b3Ioc2NvcGU6IENvbnN0cnVjdCwgaWQ6IHN0cmluZywgcHJvcHM6IEFwaVN0YWNrUHJvcHMpIHtcbiAgICBzdXBlcihzY29wZSwgaWQsIHByb3BzKTtcbiAgICB0aGlzLmFwaSA9IG5ldyBhcHBzeW5jLkdyYXBocWxBcGkodGhpcywgJ0FwaScsIHtcbiAgICAgIG5hbWU6ICd0d2l0dGVyLWFwaScsXG4gICAgICBzY2hlbWE6IGFwcHN5bmMuU2NoZW1hLmZyb21Bc3NldChcbiAgICAgICAgcGF0aC5qb2luKF9fZGlybmFtZSwgJ1NjaGVtYS9zY2hlbWEuYXBpLmdyYXBocWwnKVxuICAgICAgKSxcbiAgICAgIGF1dGhvcml6YXRpb25Db25maWc6IHtcbiAgICAgICAgZGVmYXVsdEF1dGhvcml6YXRpb246IHtcbiAgICAgICAgICBhdXRob3JpemF0aW9uVHlwZTogYXBwc3luYy5BdXRob3JpemF0aW9uVHlwZS5VU0VSX1BPT0wsXG4gICAgICAgICAgdXNlclBvb2xDb25maWc6IHtcbiAgICAgICAgICAgIHVzZXJQb29sOiBwcm9wcy51c2VyUG9vbFxuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfSxcbiAgICAgIFxuXG4gICAgfSk7XG4gICAgdGhpcy5wcm9wcyA9IHByb3BzO1xuICAgIHRoaXMucXVlcmllcygpO1xuICAgIHRoaXMubXV0YXRpb25zKCk7XG4gICAgdGhpcy5uZXN0ZWRSZXNvbHZlcnMoKTtcblxuICAgIC8vb3V0cHV0IEFQSSBVUkxcbiAgICBuZXcgY2RrLkNmbk91dHB1dCh0aGlzLCAnR3JhcGhRTEFQSVVSTCcsIHtcbiAgICAgIHZhbHVlOiB0aGlzLmFwaS5ncmFwaHFsVXJsXG4gICAgfSk7XG4gIH1cblxuICBwdWJsaWMgcXVlcmllcygpIHtcbiAgICBuZXcgR2V0TXlQcm9maWxlUmVzb2x2ZXIoXG4gICAgICB0aGlzLFxuICAgICAgJ1F1ZXJ5R2V0TXlQcm9maWxlUmVzb2x2ZXInLFxuICAgICAgdGhpcy5hcGksXG4gICAgICB0aGlzLnByb3BzLnVzZXJzVGFibGVcbiAgICApLnJlc29sdmVyO1xuXG4gICAgY29uc3QgZ2V0SW1hZ2VVcGxvYWRVcmwgPSBuZXcgR2V0SW1hZ2VVcGxvYWRVUkwoXG4gICAgICB0aGlzLFxuICAgICAgJ1F1ZXJ5R2V0SW1hZ2VVcGxvYWRVcmwnLFxuICAgICAgdGhpcy5hcGlcbiAgICApO1xuICAgIGdldEltYWdlVXBsb2FkVXJsLnJlc29sdmVyO1xuICAgIHRoaXMuaW1hZ2VVcGxvYWRGdW5jdGlvbiA9IGdldEltYWdlVXBsb2FkVXJsLmdldEltYWdlVXBsb2FkVVJMZnVuY3Rpb247XG5cbiAgICBuZXcgR2V0VHdlZXRzUmVzb2x2ZXIoXG4gICAgICB0aGlzLFxuICAgICAgJ1F1ZXJ5R2V0VHdlZXRzUmVzb2x2ZXInLFxuICAgICAgdGhpcy5hcGksXG4gICAgICB0aGlzLnByb3BzLnR3ZWV0c1RhYmxlXG4gICAgKS5yZXNvbHZlcjtcblxuICAgIG5ldyBHZXRNeVRpbWVMaW5lKFxuICAgICAgdGhpcyxcbiAgICAgICdRdWVyeUdldE15VGltZUxpbmVSZXNvbHZlcicsXG4gICAgICB0aGlzLmFwaSxcbiAgICAgIHRoaXMucHJvcHMudGltZWxpbmVzVGFibGVcbiAgICApLnJlc29sdmVyO1xuXG4gICAgbmV3IEdldExpa2VzKHRoaXMsICdRdWVyeUdldExpa2VzUmVzb2x2ZXInLCB0aGlzLmFwaSwgdGhpcy5wcm9wcy5saWtlc1RhYmxlKVxuICAgICAgLnJlc29sdmVyO1xuXG4gICAgbmV3IEdldFByb2ZpbGUodGhpcywgJ1F1ZXJ5R2V0UHJvZmlsZScsIHRoaXMuYXBpLCB0aGlzLnByb3BzLnVzZXJzVGFibGUpXG4gICAgICAucmVzb2x2ZXI7XG5cbiAgICAvLyBUaGlzIGlzIHBpcGVsaW5lIHJlc29sdmVyIGV4YW1wbGVcbiAgICBuZXcgR2V0Rm9sbG93ZXJzKFxuICAgICAgdGhpcyxcbiAgICAgICdRdWVyeUdldEZvbGxvd2VycycsXG4gICAgICB0aGlzLmFwaSxcbiAgICAgIHRoaXMucHJvcHMucmVsYXRpb25zaGlwc1RhYmxlLFxuICAgICAgdGhpcy5wcm9wcy51c2Vyc1RhYmxlXG4gICAgKS5yZXNvbHZlcjtcblxuICAgIG5ldyBHZXRGb2xsb3dpbmcoXG4gICAgICB0aGlzLFxuICAgICAgJ1F1ZXJ5R2V0Rm9sbG93aW5nJyxcbiAgICAgIHRoaXMuYXBpLFxuICAgICAgdGhpcy5wcm9wcy5yZWxhdGlvbnNoaXBzVGFibGUsXG4gICAgICB0aGlzLnByb3BzLnVzZXJzVGFibGVcbiAgICApLnJlc29sdmVyO1xuICB9XG5cbiAgcHVibGljIG5lc3RlZFJlc29sdmVycygpIHtcbiAgICBuZXcgTmVzdGVkUHJvZmlsZVR3ZWV0KFxuICAgICAgdGhpcyxcbiAgICAgICdOZXN0ZWRQcm9maWxlVHdlZXQnLFxuICAgICAgdGhpcy5hcGksXG4gICAgICB0aGlzLnByb3BzLnVzZXJzVGFibGVcbiAgICApLnJlc29sdmVyO1xuXG4gICAgbmV3IE5lc3RlZFVuaHlkcmF0ZWRUd2VldHNQYWdlKFxuICAgICAgdGhpcyxcbiAgICAgICdOZXN0ZWRVbmh5ZHJhdGVkVHdlZXRzUGFnZScsXG4gICAgICB0aGlzLmFwaSxcbiAgICAgIHRoaXMucHJvcHMudHdlZXRzVGFibGVcbiAgICApLnJlc29sdmVyO1xuXG4gICAgbmV3IE5lc3RlZExpa2VkKHRoaXMsICdOZXN0ZWRMaWtlZCcsIHRoaXMuYXBpLCB0aGlzLnByb3BzLmxpa2VzVGFibGUpXG4gICAgICAucmVzb2x2ZXI7XG4gICAgbmV3IE5lc3RlZE15UHJvZmlsZShcbiAgICAgIHRoaXMsXG4gICAgICAnTmVzdGVkTXlQcm9maWxlJyxcbiAgICAgIHRoaXMuYXBpLFxuICAgICAgdGhpcy5wcm9wcy50d2VldHNUYWJsZVxuICAgICkucmVzb2x2ZXI7XG5cbiAgICBuZXcgTmVzdGVkT3RoZXJQcm9maWxlKFxuICAgICAgdGhpcyxcbiAgICAgICdOZXN0ZWRPdGhlclByb2ZpbGUnLFxuICAgICAgdGhpcy5hcGksXG4gICAgICB0aGlzLnByb3BzLnR3ZWV0c1RhYmxlXG4gICAgKS5yZXNvbHZlcjtcblxuICAgIG5ldyBOZXN0ZWRSZXR3ZWV0UHJvZmlsZShcbiAgICAgIHRoaXMsXG4gICAgICAnTmVzdGVkUmV0d2VldFByb2ZpbGUnLFxuICAgICAgdGhpcy5hcGksXG4gICAgICB0aGlzLnByb3BzLnVzZXJzVGFibGVcbiAgICApLnJlc29sdmVyO1xuXG4gICAgbmV3IE5lc3RlZFJldHdlZXRPZihcbiAgICAgIHRoaXMsXG4gICAgICAnTmVzdGVkUmV0d2VldE9mJyxcbiAgICAgIHRoaXMuYXBpLFxuICAgICAgdGhpcy5wcm9wcy50d2VldHNUYWJsZVxuICAgICkucmVzb2x2ZXI7XG5cbiAgICBuZXcgTmVzdGVkVHdlZXRSZXR3ZWV0ZWQoXG4gICAgICB0aGlzLFxuICAgICAgJ05lc3RlZFR3ZWV0UmV0d2VldGVkJyxcbiAgICAgIHRoaXMuYXBpLFxuICAgICAgdGhpcy5wcm9wcy5yZXR3ZWV0c1RhYmxlXG4gICAgKS5yZXNvbHZlcjtcblxuICAgIG5ldyBOZXN0ZWRSZXBseVByb2ZpbGUoXG4gICAgICB0aGlzLFxuICAgICAgJ05lc3RlZFJlcGx5UHJvZmlsZScsXG4gICAgICB0aGlzLmFwaSxcbiAgICAgIHRoaXMucHJvcHMudXNlcnNUYWJsZVxuICAgICkucmVzb2x2ZXI7XG5cbiAgICBuZXcgTmVzdGVkSW5SZXBseVRvVHdlZXQoXG4gICAgICB0aGlzLFxuICAgICAgJ05lc3RlZEluUmVwbHlUb1R3ZWV0JyxcbiAgICAgIHRoaXMuYXBpLFxuICAgICAgdGhpcy5wcm9wcy50d2VldHNUYWJsZVxuICAgICkucmVzb2x2ZXI7XG5cbiAgICBuZXcgTmVzdGVkSW5SZXBseVRvVXNlcnMoXG4gICAgICB0aGlzLFxuICAgICAgJ05lc3RlZEluUmVwbHlUb1VzZXJzJyxcbiAgICAgIHRoaXMuYXBpLFxuICAgICAgdGhpcy5wcm9wcy51c2Vyc1RhYmxlXG4gICAgKS5yZXNvbHZlcjtcblxuICAgIG5ldyBOZXN0ZWRSZXBseVJldHdlZXRlZChcbiAgICAgIHRoaXMsXG4gICAgICAnTmVzdGVkUmVwbHlSZXR3ZWV0ZWQnLFxuICAgICAgdGhpcy5hcGksXG4gICAgICB0aGlzLnByb3BzLnJldHdlZXRzVGFibGVcbiAgICApLnJlc29sdmVyO1xuXG4gICAgbmV3IE5lc3RlZFJlcGx5TGlrZShcbiAgICAgIHRoaXMsXG4gICAgICAnTmVzdGVkUmVwbHlMaWtlJyxcbiAgICAgIHRoaXMuYXBpLFxuICAgICAgdGhpcy5wcm9wcy5saWtlc1RhYmxlXG4gICAgKS5yZXNvbHZlcjtcblxuICAgIG5ldyBOZXN0ZWRGb2xsb3dpbmdPdGhlclByb2ZpbGUoXG4gICAgICB0aGlzLFxuICAgICAgJ05lc3RlZEZvbGxvd2luZ090aGVyUHJvZmlsZScsXG4gICAgICB0aGlzLmFwaSxcbiAgICAgIHRoaXMucHJvcHMucmVsYXRpb25zaGlwc1RhYmxlXG4gICAgKS5yZXNvbHZlcjtcblxuICAgIG5ldyBOZXN0ZWRGb2xsb3dlZEJ5T3RoZXJQcm9maWxlKFxuICAgICAgdGhpcyxcbiAgICAgICdOZXN0ZWRGb2xsb3dlZEJ5T3RoZXJQcm9maWxlJyxcbiAgICAgIHRoaXMuYXBpLFxuICAgICAgdGhpcy5wcm9wcy5yZWxhdGlvbnNoaXBzVGFibGVcbiAgICApLnJlc29sdmVyO1xuICB9XG5cbiAgLy8gaWQgc3RyaW5nIHNob3VsZCBiZSB1bmlxdWUgZm9yIGVhY2ggY29uc3RydWN0XG4gIHB1YmxpYyBtdXRhdGlvbnMoKSB7XG4gICAgbmV3IEVkaXRNeVByb2ZpbGUoXG4gICAgICB0aGlzLFxuICAgICAgJ0VkaXRNeVByb2ZpbGVSZXNvbHZlcicsXG4gICAgICB0aGlzLmFwaSxcbiAgICAgIHRoaXMucHJvcHMudXNlcnNUYWJsZVxuICAgICkucmVzb2x2ZXI7XG5cbiAgICAvL1R3ZWV0IE11dGF0aW9uXG4gICAgY29uc3QgdHdlZXRNdXRhdGlvbiA9IG5ldyBUd2VldCh0aGlzLCAnVHdlZXRNdXRhdGlvbicsIHRoaXMuYXBpKTtcbiAgICB0d2VldE11dGF0aW9uLnJlc29sdmVyO1xuICAgIHRoaXMucHJvcHMudXNlcnNUYWJsZS5ncmFudEZ1bGxBY2Nlc3ModHdlZXRNdXRhdGlvbi5Ud2VldGZ1bmN0aW9uKTtcbiAgICB0aGlzLnByb3BzLnR3ZWV0c1RhYmxlLmdyYW50RnVsbEFjY2Vzcyh0d2VldE11dGF0aW9uLlR3ZWV0ZnVuY3Rpb24pO1xuICAgIHRoaXMucHJvcHMudGltZWxpbmVzVGFibGUuZ3JhbnRGdWxsQWNjZXNzKHR3ZWV0TXV0YXRpb24uVHdlZXRmdW5jdGlvbik7XG5cbiAgICAvL1JldHdlZXRNdXRhdGlvblxuICAgIGNvbnN0IHJldHdlZXRNdXRhdGlvbiA9IG5ldyBSZXR3ZWV0KHRoaXMsICdSZXR3ZWV0TXV0YXRpb24nLCB0aGlzLmFwaSk7XG4gICAgcmV0d2VldE11dGF0aW9uLnJlc29sdmVyO1xuICAgIHRoaXMucHJvcHMudXNlcnNUYWJsZS5ncmFudEZ1bGxBY2Nlc3MocmV0d2VldE11dGF0aW9uLlJldHdlZXRmdW5jdGlvbik7XG4gICAgdGhpcy5wcm9wcy50d2VldHNUYWJsZS5ncmFudEZ1bGxBY2Nlc3MocmV0d2VldE11dGF0aW9uLlJldHdlZXRmdW5jdGlvbik7XG4gICAgdGhpcy5wcm9wcy50aW1lbGluZXNUYWJsZS5ncmFudEZ1bGxBY2Nlc3MocmV0d2VldE11dGF0aW9uLlJldHdlZXRmdW5jdGlvbik7XG4gICAgdGhpcy5wcm9wcy5yZXR3ZWV0c1RhYmxlLmdyYW50RnVsbEFjY2VzcyhyZXR3ZWV0TXV0YXRpb24uUmV0d2VldGZ1bmN0aW9uKTtcblxuICAgIC8vVW5SZXR3ZWV0TXV0YXRpb25cbiAgICBjb25zdCB1bnJldHdlZXRNdXRhdGlvbiA9IG5ldyBVblJldHdlZXQoXG4gICAgICB0aGlzLFxuICAgICAgJ1VuUmV0d2VldE11dGF0aW9uJyxcbiAgICAgIHRoaXMuYXBpXG4gICAgKTtcbiAgICB1bnJldHdlZXRNdXRhdGlvbi5yZXNvbHZlcjtcbiAgICB0aGlzLnByb3BzLnVzZXJzVGFibGUuZ3JhbnRGdWxsQWNjZXNzKHVucmV0d2VldE11dGF0aW9uLlVuUmV0d2VldEZ1bmN0aW9uKTtcbiAgICB0aGlzLnByb3BzLnR3ZWV0c1RhYmxlLmdyYW50RnVsbEFjY2Vzcyh1bnJldHdlZXRNdXRhdGlvbi5VblJldHdlZXRGdW5jdGlvbik7XG4gICAgdGhpcy5wcm9wcy50aW1lbGluZXNUYWJsZS5ncmFudEZ1bGxBY2Nlc3MoXG4gICAgICB1bnJldHdlZXRNdXRhdGlvbi5VblJldHdlZXRGdW5jdGlvblxuICAgICk7XG4gICAgdGhpcy5wcm9wcy5yZXR3ZWV0c1RhYmxlLmdyYW50RnVsbEFjY2VzcyhcbiAgICAgIHVucmV0d2VldE11dGF0aW9uLlVuUmV0d2VldEZ1bmN0aW9uXG4gICAgKTtcblxuICAgIC8vUmVwbHlNdXRhdGlvblxuICAgIGNvbnN0IHJlcGx5TXV0YXRpb24gPSBuZXcgUmVwbHkodGhpcywgJ1JlcGx5TXV0YXRpb24nLCB0aGlzLmFwaSk7XG4gICAgcmVwbHlNdXRhdGlvbi5yZXNvbHZlcjtcbiAgICB0aGlzLnByb3BzLnVzZXJzVGFibGUuZ3JhbnRGdWxsQWNjZXNzKHJlcGx5TXV0YXRpb24uUmVwbHlmdW5jdGlvbik7XG4gICAgdGhpcy5wcm9wcy50d2VldHNUYWJsZS5ncmFudEZ1bGxBY2Nlc3MocmVwbHlNdXRhdGlvbi5SZXBseWZ1bmN0aW9uKTtcbiAgICB0aGlzLnByb3BzLnRpbWVsaW5lc1RhYmxlLmdyYW50RnVsbEFjY2VzcyhyZXBseU11dGF0aW9uLlJlcGx5ZnVuY3Rpb24pO1xuXG4gICAgLy9MaWtlIE11dGF0aW9uXG4gICAgLy8gTWFudWFsbHkgaGF2ZSB0byBhZGQgYWNjZXNzIGluIHRoZSBzZXJ2aWNlIHJvbGUgZnJvbSBjb25zb2xlIGZvciB0d2VldHMgYW5kIHVzZXJzIHRhYmxlXG4gICAgY29uc3QgTGlrZU11dGF0aW9uID0gbmV3IExpa2UoXG4gICAgICB0aGlzLFxuICAgICAgJ0xpa2VNdXRhdGlvbicsXG4gICAgICB0aGlzLmFwaSxcbiAgICAgIHRoaXMucHJvcHMubGlrZXNUYWJsZVxuICAgICk7XG4gICAgTGlrZU11dGF0aW9uLnJlc29sdmVyO1xuXG4gICAgLy9Vbmxpa2UgTXV0YXRpb25cbiAgICAvLyBNYW51YWxseSBoYXZlIHRvIGFkZCBhY2Nlc3MgaW4gdGhlIHNlcnZpY2Ugcm9sZSBmcm9tIGNvbnNvbGUgZm9yIHR3ZWV0cyBhbmQgdXNlcnMgdGFibGVcblxuICAgIGNvbnN0IFVubGlrZU11dGF0aW9uID0gbmV3IFVubGlrZShcbiAgICAgIHRoaXMsXG4gICAgICAnVW5saWtlTXV0YXRpb24nLFxuICAgICAgdGhpcy5hcGksXG4gICAgICB0aGlzLnByb3BzLmxpa2VzVGFibGVcbiAgICApO1xuICAgIFVubGlrZU11dGF0aW9uLnJlc29sdmVyO1xuXG4gICAgLy9Gb2xsb3cgTXV0YXRpb25cbiAgICAvLyBNYW51YWxseSBhZGQgYWNjZXNzIGluIHRoZSBzZXJ2aWNlIHJvbGUgZnJvbSBjb25zb2xlIGZvciB1c2VycyB0YWJsZVxuICAgIGNvbnN0IEZvbGxvd011dGF0aW9uID0gbmV3IEZvbGxvdyhcbiAgICAgIHRoaXMsXG4gICAgICAnRm9sbG93TXV0YXRpb24nLFxuICAgICAgdGhpcy5hcGksXG4gICAgICB0aGlzLnByb3BzLnJlbGF0aW9uc2hpcHNUYWJsZVxuICAgICkucmVzb2x2ZXI7XG5cbiAgICAvL1VuZm9sbG93IE11dGF0aW9uXG4gICAgLy8gTWFudWFsbHkgYWRkIGFjY2VzcyBpbiB0aGUgc2VydmljZSByb2xlIGZyb20gY29uc29sZSBmb3IgdXNlcnMgdGFibGVcbiAgICBjb25zdCBVbmZvbGxvd011dGF0aW9uID0gbmV3IFVuRm9sbG93KFxuICAgICAgdGhpcyxcbiAgICAgICdVbmZvbGxvd011dGF0aW9uJyxcbiAgICAgIHRoaXMuYXBpLFxuICAgICAgdGhpcy5wcm9wcy5yZWxhdGlvbnNoaXBzVGFibGVcbiAgICApLnJlc29sdmVyO1xuICB9XG59XG4iXX0=
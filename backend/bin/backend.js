"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const amplify_stack_1 = require("./../lib/stacks/AmplifyStack/amplify-stack");
const storage_stack_1 = require("./../lib/stacks/StorageStack/storage-stack");
const database_stack_1 = require("./../lib/stacks/DatabaseStack/database-stack");
const compute_stack_1 = require("./../lib/stacks/ComputeStack/compute-stack");
const user_pool_stack_1 = require("./../lib/stacks/CognitoStack/user-pool-stack");
const api_stack_1 = require("./../lib/stacks/API_STACK/api-stack");
// #!/usr/bin/env node
require("source-map-support/register");
const cdk = require("aws-cdk-lib");
/*
 * First We Deploy the User Pool Stack to get the User Pool Id for Api Stack
 * Order Matters
 * User Pool for handling Signups and Logins and users
 * User Pool Client for Web ,Mobile Clients
 */
const app = new cdk.App();
const computeStack = new compute_stack_1.ComputeStack(app, 'ComputeStack');
const userPoolStack = new user_pool_stack_1.UserPoolStack(app, 'UserPoolStack', {
    postConfirmationHook: computeStack.postConfirmationHook
});
const dataBaseStack = new database_stack_1.DataBaseStack(app, 'DataBaseStack', {
    postConfirmationHook: computeStack.postConfirmationHook,
    distributedTweet: computeStack.distributedTweet,
    distributeTweetWithFollowers: computeStack.distributeTweetToFollowers,
    syncUserstoAlgolia: computeStack.syncUsersToAlgolia,
    syncTweetsToAlgolia: computeStack.syncTweetsToAlgolia,
    Notify: computeStack.Notify
});
const apiStack = new api_stack_1.ApiStack(app, 'ApiStack', {
    userPool: userPoolStack.userPool,
    usersTable: dataBaseStack.usersTable.table,
    tweetsTable: dataBaseStack.tweetsTable.table,
    timelinesTable: dataBaseStack.timelinesTable.table,
    likesTable: dataBaseStack.likesTable.table,
    retweetsTable: dataBaseStack.retweetTable.table,
    relationshipsTable: dataBaseStack.relationShipsTable.table,
    notificationsTable: dataBaseStack.notificationsTable.table
});
const storageStack = new storage_stack_1.StorageStack(app, 'StorageStack', {
    imageUploadFunction: apiStack.imageUploadFunction
});
const frontEndStack = new amplify_stack_1.AmplifyStack(app, 'AmplifyStack');
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiYmFja2VuZC5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbImJhY2tlbmQudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7QUFBQSw4RUFBMEU7QUFDMUUsOEVBQTBFO0FBQzFFLGlGQUE2RTtBQUM3RSw4RUFBMEU7QUFDMUUsa0ZBQTZFO0FBQzdFLG1FQUErRDtBQUMvRCxzQkFBc0I7QUFFdEIsdUNBQXFDO0FBQ3JDLG1DQUFtQztBQUVuQzs7Ozs7R0FLRztBQUNILE1BQU0sR0FBRyxHQUFHLElBQUksR0FBRyxDQUFDLEdBQUcsRUFBRSxDQUFDO0FBQzFCLE1BQU0sWUFBWSxHQUFHLElBQUksNEJBQVksQ0FBQyxHQUFHLEVBQUUsY0FBYyxDQUFDLENBQUM7QUFDM0QsTUFBTSxhQUFhLEdBQUcsSUFBSSwrQkFBYSxDQUFDLEdBQUcsRUFBRSxlQUFlLEVBQUU7SUFDNUQsb0JBQW9CLEVBQUUsWUFBWSxDQUFDLG9CQUFvQjtDQUN4RCxDQUFDLENBQUM7QUFFSCxNQUFNLGFBQWEsR0FBRyxJQUFJLDhCQUFhLENBQUMsR0FBRyxFQUFFLGVBQWUsRUFBRTtJQUM1RCxvQkFBb0IsRUFBRSxZQUFZLENBQUMsb0JBQW9CO0lBQ3ZELGdCQUFnQixFQUFFLFlBQVksQ0FBQyxnQkFBZ0I7SUFDL0MsNEJBQTRCLEVBQUUsWUFBWSxDQUFDLDBCQUEwQjtJQUNyRSxrQkFBa0IsRUFBRSxZQUFZLENBQUMsa0JBQWtCO0lBQ25ELG1CQUFtQixFQUFFLFlBQVksQ0FBQyxtQkFBbUI7SUFDckQsTUFBTSxFQUFFLFlBQVksQ0FBQyxNQUFNO0NBQzVCLENBQUMsQ0FBQztBQUVILE1BQU0sUUFBUSxHQUFHLElBQUksb0JBQVEsQ0FBQyxHQUFHLEVBQUUsVUFBVSxFQUFFO0lBQzdDLFFBQVEsRUFBRSxhQUFhLENBQUMsUUFBUTtJQUNoQyxVQUFVLEVBQUUsYUFBYSxDQUFDLFVBQVUsQ0FBQyxLQUFLO0lBQzFDLFdBQVcsRUFBRSxhQUFhLENBQUMsV0FBVyxDQUFDLEtBQUs7SUFDNUMsY0FBYyxFQUFFLGFBQWEsQ0FBQyxjQUFjLENBQUMsS0FBSztJQUNsRCxVQUFVLEVBQUUsYUFBYSxDQUFDLFVBQVUsQ0FBQyxLQUFLO0lBQzFDLGFBQWEsRUFBRSxhQUFhLENBQUMsWUFBWSxDQUFDLEtBQUs7SUFDL0Msa0JBQWtCLEVBQUUsYUFBYSxDQUFDLGtCQUFrQixDQUFDLEtBQUs7SUFDMUQsa0JBQWtCLEVBQUUsYUFBYSxDQUFDLGtCQUFrQixDQUFDLEtBQUs7Q0FDM0QsQ0FBQyxDQUFDO0FBRUgsTUFBTSxZQUFZLEdBQUcsSUFBSSw0QkFBWSxDQUFDLEdBQUcsRUFBRSxjQUFjLEVBQUU7SUFDekQsbUJBQW1CLEVBQUUsUUFBUSxDQUFDLG1CQUFtQjtDQUNsRCxDQUFDLENBQUM7QUFDSCxNQUFNLGFBQWEsR0FBRyxJQUFJLDRCQUFZLENBQUMsR0FBRyxFQUFFLGNBQWMsQ0FBQyxDQUFDIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgQW1wbGlmeVN0YWNrIH0gZnJvbSAnLi8uLi9saWIvc3RhY2tzL0FtcGxpZnlTdGFjay9hbXBsaWZ5LXN0YWNrJztcbmltcG9ydCB7IFN0b3JhZ2VTdGFjayB9IGZyb20gJy4vLi4vbGliL3N0YWNrcy9TdG9yYWdlU3RhY2svc3RvcmFnZS1zdGFjayc7XG5pbXBvcnQgeyBEYXRhQmFzZVN0YWNrIH0gZnJvbSAnLi8uLi9saWIvc3RhY2tzL0RhdGFiYXNlU3RhY2svZGF0YWJhc2Utc3RhY2snO1xuaW1wb3J0IHsgQ29tcHV0ZVN0YWNrIH0gZnJvbSAnLi8uLi9saWIvc3RhY2tzL0NvbXB1dGVTdGFjay9jb21wdXRlLXN0YWNrJztcbmltcG9ydCB7IFVzZXJQb29sU3RhY2sgfSBmcm9tICcuLy4uL2xpYi9zdGFja3MvQ29nbml0b1N0YWNrL3VzZXItcG9vbC1zdGFjayc7XG5pbXBvcnQgeyBBcGlTdGFjayB9IGZyb20gJy4vLi4vbGliL3N0YWNrcy9BUElfU1RBQ0svYXBpLXN0YWNrJztcbi8vICMhL3Vzci9iaW4vZW52IG5vZGVcblxuaW1wb3J0ICdzb3VyY2UtbWFwLXN1cHBvcnQvcmVnaXN0ZXInO1xuaW1wb3J0ICogYXMgY2RrIGZyb20gJ2F3cy1jZGstbGliJztcblxuLypcbiAqIEZpcnN0IFdlIERlcGxveSB0aGUgVXNlciBQb29sIFN0YWNrIHRvIGdldCB0aGUgVXNlciBQb29sIElkIGZvciBBcGkgU3RhY2tcbiAqIE9yZGVyIE1hdHRlcnNcbiAqIFVzZXIgUG9vbCBmb3IgaGFuZGxpbmcgU2lnbnVwcyBhbmQgTG9naW5zIGFuZCB1c2Vyc1xuICogVXNlciBQb29sIENsaWVudCBmb3IgV2ViICxNb2JpbGUgQ2xpZW50c1xuICovXG5jb25zdCBhcHAgPSBuZXcgY2RrLkFwcCgpO1xuY29uc3QgY29tcHV0ZVN0YWNrID0gbmV3IENvbXB1dGVTdGFjayhhcHAsICdDb21wdXRlU3RhY2snKTtcbmNvbnN0IHVzZXJQb29sU3RhY2sgPSBuZXcgVXNlclBvb2xTdGFjayhhcHAsICdVc2VyUG9vbFN0YWNrJywge1xuICBwb3N0Q29uZmlybWF0aW9uSG9vazogY29tcHV0ZVN0YWNrLnBvc3RDb25maXJtYXRpb25Ib29rXG59KTtcblxuY29uc3QgZGF0YUJhc2VTdGFjayA9IG5ldyBEYXRhQmFzZVN0YWNrKGFwcCwgJ0RhdGFCYXNlU3RhY2snLCB7XG4gIHBvc3RDb25maXJtYXRpb25Ib29rOiBjb21wdXRlU3RhY2sucG9zdENvbmZpcm1hdGlvbkhvb2ssXG4gIGRpc3RyaWJ1dGVkVHdlZXQ6IGNvbXB1dGVTdGFjay5kaXN0cmlidXRlZFR3ZWV0LFxuICBkaXN0cmlidXRlVHdlZXRXaXRoRm9sbG93ZXJzOiBjb21wdXRlU3RhY2suZGlzdHJpYnV0ZVR3ZWV0VG9Gb2xsb3dlcnMsXG4gIHN5bmNVc2Vyc3RvQWxnb2xpYTogY29tcHV0ZVN0YWNrLnN5bmNVc2Vyc1RvQWxnb2xpYSxcbiAgc3luY1R3ZWV0c1RvQWxnb2xpYTogY29tcHV0ZVN0YWNrLnN5bmNUd2VldHNUb0FsZ29saWEsXG4gIE5vdGlmeTogY29tcHV0ZVN0YWNrLk5vdGlmeVxufSk7XG5cbmNvbnN0IGFwaVN0YWNrID0gbmV3IEFwaVN0YWNrKGFwcCwgJ0FwaVN0YWNrJywge1xuICB1c2VyUG9vbDogdXNlclBvb2xTdGFjay51c2VyUG9vbCxcbiAgdXNlcnNUYWJsZTogZGF0YUJhc2VTdGFjay51c2Vyc1RhYmxlLnRhYmxlLFxuICB0d2VldHNUYWJsZTogZGF0YUJhc2VTdGFjay50d2VldHNUYWJsZS50YWJsZSxcbiAgdGltZWxpbmVzVGFibGU6IGRhdGFCYXNlU3RhY2sudGltZWxpbmVzVGFibGUudGFibGUsXG4gIGxpa2VzVGFibGU6IGRhdGFCYXNlU3RhY2subGlrZXNUYWJsZS50YWJsZSxcbiAgcmV0d2VldHNUYWJsZTogZGF0YUJhc2VTdGFjay5yZXR3ZWV0VGFibGUudGFibGUsXG4gIHJlbGF0aW9uc2hpcHNUYWJsZTogZGF0YUJhc2VTdGFjay5yZWxhdGlvblNoaXBzVGFibGUudGFibGUsXG4gIG5vdGlmaWNhdGlvbnNUYWJsZTogZGF0YUJhc2VTdGFjay5ub3RpZmljYXRpb25zVGFibGUudGFibGVcbn0pO1xuXG5jb25zdCBzdG9yYWdlU3RhY2sgPSBuZXcgU3RvcmFnZVN0YWNrKGFwcCwgJ1N0b3JhZ2VTdGFjaycsIHtcbiAgaW1hZ2VVcGxvYWRGdW5jdGlvbjogYXBpU3RhY2suaW1hZ2VVcGxvYWRGdW5jdGlvblxufSk7XG5jb25zdCBmcm9udEVuZFN0YWNrID0gbmV3IEFtcGxpZnlTdGFjayhhcHAsICdBbXBsaWZ5U3RhY2snKTtcbiJdfQ==